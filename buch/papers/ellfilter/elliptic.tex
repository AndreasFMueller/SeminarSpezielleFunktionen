\section{Elliptische rationale Funktionen}

Kommen wir nun zum eigentlichen Teil dieses Papers, den elliptischen rationalen Funktionen
\begin{align}
    R_N(\xi, w) &= \cd \left(N~f_1(\xi)~\cd^{-1}(w, 1/\xi), f_2(\xi)\right) \\
                &= \cd \left(N~\frac{K_1}{K}~\cd^{-1}(w, k), k_1)\right) , \quad k= 1/\xi, k_1 = 1/f(\xi) \\
                &= \cd \left(N~K_1~z , k_1 \right), \quad w= \cd(z K, k)
\end{align}
Beim Betrachten dieser Definition, fällt die Ähnlichkeit zur trigonometrische Darstellung der Tschebyschef-Polynome \eqref{ellfilter:eq:chebychef_polynomials} auf.
Anstelle vom Kosinus kommt hier die $\cd$-Funktion zum Einsatz.
Die Ordnungszahl $N$ kommt auch als Faktor for.
Zusätzlich werden noch zwei verschiedene elliptische Module $k$ und $k_1$ gebraucht.
Bei $k = k_1 = 0$ wird der $\cd$ zum Kosinus und wir erhalten in diesem Spezialfall die Tschebyschef-Polynome.

Durch das Konzept vom fundamentalen Rechteck, siehe Abbildung \ref{buch:elliptisch:fig:ellall} können für alle inversen Jacobi elliptischen Funktionen die Positionen der Null- und Polstellen anhand eines Diagramms ermittelt werden.
Die $\cd^{-1}(w, k)$-Funktion ist um $K$ verschoben zur $\sn^{-1}(w, k)$-Funktion, wie ersichtlich in Abbildung \ref{ellfilter:fig:cd}.
\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/cd.tikz.tex}
    \caption{
        $z$-Ebene der Funktion $z = \cd^{-1}(w, k)$.
        Die Funktion ist in der realen Achse $4K$-periodisch und in der imaginären Achse $2jK^\prime$-periodisch.
    }
    \label{ellfilter:fig:cd}
\end{figure}
Auffallend an der $w = \cd(z, k)$-Funktion ist, dass sich $w$ auf der reellen Achse wie der Kosinus immer zwischen $-1$ und $1$ bewegt, während bei $\mathrm{Im(z) = K^\prime}$ die Werte zwischen $\pm 1/k$ und $\pm \infty$ verlaufen.
Die Funktion hat also Equirippel-Verhalten um $w=0$ und um $w=\pm \infty$. %TODO Check
Falls es möglich ist diese Werte abzufahren im Stil der Tschebyscheff-Polynome, kann ein Filter gebaut werden, dass Equirippel-Verhalten im Durchlass- und Sperrbereich aufweist.

Analog zu Abbildung \ref{ellfilter:fig:arccos2} können wir auch bei den elliptisch rationalen Funktionen die komplexe $z$-Ebene betrachten, wie ersichtlich in Abbildung \ref{ellfilter:fig:cd2}, um die besser zu verstehen.
\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/cd2.tikz.tex}
    \caption{
        $z_1$-Ebene der elliptischen rationalen Funktionen.
        Je grösser die Ordnung $N$ gewählt wird, desto mehr Nullstellen passiert.
    }
    \label{ellfilter:fig:cd2}
\end{figure}
% Da die $\cd^{-1}$-Funktion 

\begin{figure}
    \centering
    \input{papers/ellfilter/python/elliptic.pgf}
    \caption{$F_N$ und die resultierende Frequenzantwort eines elliptischen Filters.}
    \label{ellfilter:fig:elliptic_freq}
\end{figure}

\subsection{Gradgleichung}

Der $\cd^{-1}$ Term muss so verzogen werden, dass die umgebene $\cd$-Funktion die Nullstellen und Pole trifft.
Dies trifft ein wenn die Gradengleichung erfüllt ist.

\begin{equation}
    N \frac{K^\prime}{K} = \frac{K^\prime_1}{K_1}
\end{equation}


Leider ist das lösen dieser Gleichung nicht trivial.
Die Rechnung wird in \ref{ellfilter:bib:orfanidis} im Detail angeschaut.

$K$ und $K^\prime$ sind voneinender abhängig.

Das Problem lässt sich grafisch darstellen.

\begin{figure}
    \centering
    \input{papers/ellfilter/python/k.pgf}
    \caption{Die Periodizitäten in realer und imaginärer Richtung in Abhängigkeit vom elliptischen Modul $k$.}
\end{figure}

%TODO combine figures?
\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/elliptic_transform1.tikz}
    \caption{Die Gradgleichung als geometrisches Problem.}
\end{figure}
\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/elliptic_transform2.tikz}
    \caption{Die Gradgleichung als geometrisches Problem.}
\end{figure}

\subsection{Polynome?}

Bei den Tschebyscheff-Polynomen haben wir gesehen, dass die Trigonometrische Formel zu einfachen Polynomen umgewandelt werden kann.
Im gegensatz zum $\cos^{-1}$ hat der $\cd^{-1}$ nicht nur Nullstellen sondern auch Pole.
Somit entstehen bei den elliptischen rationalen Funktionen, wie es der name auch deutet, rationale Funktionen, also ein Bruch von zwei Polynomen.

Da Transformationen einer rationalen Funktionen mit Grundrechenarten, wie es in \eqref{ellfilter:eq:h_omega} der Fall ist, immer noch rationale Funktionen ergeben, stellt dies kein Problem für die Implementierung dar.
