\section{Elliptische rationale Funktionen}

Kommen wir nun zum eigentlichen Teil dieses Papers, den elliptischen rationalen Funktionen
\begin{align}
    R_N(\xi, w) &= \cd \left(N~f_1(\xi)~\cd^{-1}(w, 1/\xi), f_2(\xi)\right) \\
                &= \cd \left(N~\frac{K_1}{K}~\cd^{-1}(w, k), k_1)\right) , \quad k= 1/\xi, k_1 = 1/f(\xi) \\
                &= \cd \left(N~K_1~z , k_1 \right), \quad w= \cd(z K, k)
\end{align}


sieht ähnlich aus wie die trigonometrische Darstellung der Tschebyschef-Polynome \eqref{ellfilter:eq:chebychef_polynomials}
Anstelle vom Kosinus kommt hier die $\cd$-Funktion zum Einsatz.
Die Ordnungszahl $N$ kommt auch als Faktor for.
Zusätzlich werden noch zwei verschiedene elliptische Module $k$ und $k_1$ gebraucht.



Sinus entspricht $\sn$

Damit die Nullstellen an ähnlichen Positionen zu liegen kommen wie bei den Tschebyscheff-Polynomen, muss die $\cd$-Funktion gewählt werden.

Die $\cd^{-1}(w, k)$-Funktion ist um $K$ verschoben zur $\sn^{-1}(w, k)$-Funktion, wie ersichtlich in Abbildung \ref{ellfilter:fig:cd}.
\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/cd.tikz.tex}
    \caption{
        $z$-Ebene der Funktion $z = \sn^{-1}(w, k)$.
        Die Funktion ist in der realen Achse $4K$-periodisch und in der imaginären Achse $2jK^\prime$-periodisch.
    }
    \label{ellfilter:fig:cd}
\end{figure}
Auffallend ist, dass sich alle Nullstellen und Polstellen um $K$ verschoben haben.

Durch das Konzept vom fundamentalen Rechteck, siehe Abbildung \ref{ellfilter:fig:fundamental_rectangle} können für alle inversen Jaccobi elliptischen Funktionen die Positionen der Null- und Polstellen anhand eines Diagramms ermittelt werden.
Der erste Buchstabe bestimmt die Position der Nullstelle und der zweite Buchstabe die Polstelle.
\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/fundamental_rectangle.tikz.tex}
    \caption{
        Fundamentales Rechteck der inversen Jaccobi elliptischen Funktionen.
    }
    \label{ellfilter:fig:fundamental_rectangle}
\end{figure}

Auffallend an der $w = \sn(z, k)$-Funktion ist, dass sich $w$ auf der reellen Achse wie der Kosinus immer zwischen $-1$ und $1$ bewegt, während bei $\mathrm{Im(z) = K^\prime}$ die Werte zwischen $\pm 1/k$ und $\pm \infty$ verlaufen.
Die Funktion hat also Equirippel-Verhalten um $w=0$ und um $w=\pm \infty$.
Falls es möglich ist diese Werte abzufahren im Sti der Tschebyscheff-Polynome, kann ein Filter gebaut werden, dass Equirippel-Verhalten im Durchlass- und Sperrbereich aufweist.



Analog zu Abbildung \ref{ellfilter:fig:arccos2} können wir auch bei den elliptisch rationalen Funktionen die komplexe $z$-Ebene betrachten, wie ersichtlich in Abbildung \ref{ellfilter:fig:cd2}, um die besser zu verstehen.
\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/cd2.tikz.tex}
    \caption{
        $z_1$-Ebene der elliptischen rationalen Funktionen.
        Je grösser die Ordnung $N$ gewählt wird, desto mehr Nullstellen passiert.
    }
    \label{ellfilter:fig:cd2}
\end{figure}
% Da die $\cd^{-1}$-Funktion 



\begin{figure}
    \centering
    \input{papers/ellfilter/python/F_N_elliptic.pgf}
    \caption{$F_N$ für ein elliptischs filter.}
    \label{ellfilter:fig:elliptic}
\end{figure}


\begin{figure}
    \centering
    \input{papers/ellfilter/python/elliptic.pgf}
    \caption{Die resultierende frequenzantwort eines elliptischs filter.}
    \label{ellfilter:fig:elliptic_freq}
\end{figure}

\subsection{Gradgleichung}

Der $\cd^{-1}$ Term muss so verzogen werden, dass die umgebene $\cd$-Funktion die Nullstellen und Pole trifft.
Dies trifft ein wenn die Degree Equation erfüllt ist.

\begin{equation}
    N \frac{K^\prime}{K} = \frac{K^\prime_1}{K_1}
\end{equation}


Leider ist das lösen dieser Gleichung nicht trivial.
Die Rechnung wird in \ref{ellfilter:bib:orfanidis} im Detail angeschaut.

\begin{figure}
    \centering
    \input{papers/ellfilter/python/k.pgf}
    \caption{Die Periodizitäten in realer und imaginärer Richtung in Abhängigkeit vom elliptischen Modul $k$.}
\end{figure}

\begin{figure}
    \centering
    \input{papers/ellfilter/tikz/elliptic_transform.tikz}
    \caption{Die Gradgleichung als geometrisches Problem.}
\end{figure}



\subsection{Polynome?}

Bei den Tschebyscheff-Polynomen haben wir gesehen, dass die Trigonometrische Formel zu einfachen Polynomen umgewandelt werden kann.
Im gegensatz zum $\cos^{-1}$ hat der $\cd^{-1}$ nicht nur Nullstellen sondern auch Pole.
Somit entstehen bei den elliptischen rationalen Funktionen, wie es der name auch deutet, rationale Funktionen, also ein Bruch von zwei Polynomen.

Da Transformationen einer rationalen Funktionen mit Grundrechenarten, wie es in \eqref{ellfilter:eq:h_omega} der Fall ist, immer noch rationale Funktionen ergeben, stellt dies kein Problem für die Implementierung dar.
