% vim:ts=2 sw=2 et spell tw=80:
\section{Long Proofs}

Here, we will give the long and tedious proofs we skipped earlier.

\subsection{Legendre Polynomials} \label{kugel:sec:proofs:legendre}

\begin{proof}[Proof of lemma \ref{kugel:thm:legendre-poly}]
  It was stated that the polynomial function
  \begin{equation*}
    P_n(z) = \sum^{\lfloor n/2 \rfloor}_{k=0}
      \frac{(-1)^k}{2^n s^k!} \frac{(2n - 2k)!}{(n - k)! (n-2k)!} z^{n - 2k}
  \end{equation*}
  is the only finite solution of the Legendre equation
  \begin{equation}
    \label{kugel:eqn:legendre-bis}
    (1 - z^2)\frac{d^2 Z}{dz^2}
    - 2z\frac{d Z}{dz}
    + n(n + 1) Z(z) = 0,
  \end{equation}
  when $n \in \mathbb{Z}$ and $z \in [-1; 1]$. In order to prove this fact, we
  begin with the power series \emph{Ansatz}
  \begin{equation*}
    Z(x) = \sum_{k=0}^\infty a_k z^k,
    \quad\text{from which follows that}\quad
    \frac{dZ}{dz} = \sum_{k=0}^\infty k a_k z^{k-1}, \qquad
    \frac{d^2 Z}{dz^2} = \sum_{k=0}^\infty k (k-1) a_k z^{k-2}.
  \end{equation*}
  Since the power series method converges only up to the nearest singularity,
  which is at $z=1$ (and $z=-1$), we shall remark that we will find a solution
  only for $|z|<1$. Using the \emph{Ansatz} the Legendre equation
  \eqref{kugel:eqn:legendre-bis} can be rewritten as
  \begin{align}
    0 &= (1-z^2) \sum_{k=0}^\infty k (k-1) a_k z^{k-2}
      - 2z\sum_{k=0}^\infty k a_k z^{k-1}
      + n(n+1)\sum_{k=0}^\infty a_k z^k \nonumber \\
    &= \sum_{k=0}^\infty k (k-1) a_k z^{k-2}
      - \sum_{k=0}^\infty k (k-1) a_k z^{k}
      - 2z\sum_{k=0}^\infty k a_k z^{k-1}
      + n(n+1)\sum_{k=0}^\infty a_k z^k. \label{kugel:eqn:legendre-ansatz}
  \end{align}
  Considers that by shifting the index $k$ in the sum of first term
  \begin{equation*}
    \sum_{k=0}^\infty k (k-1) a_k z^{k-2}
    = \sum_{k=-2}^\infty (k+2)(k+1) a_{k+2} z^k
    = \sum_{k=0}^\infty (k+2)(k+1) a_k z^k,
  \end{equation*}
  since when $k = -1$ or $-2$ the summand is zero. This means that
  \eqref{kugel:eqn:legendre-ansatz} becomes
  \begin{align*}
    \sum_{k=0}^\infty &(k+1)(k+2) a_{k+2} z^{k}
      - \sum_{k=0}^\infty k (k-1) a_k z^{k}
      - 2\sum_{k=0}^\infty k a_k z^k
      + n(n+1)\sum_{k=0}^\infty a_k z^k \nonumber \\
    &= \sum_{k=0}^\infty \big[
      (k+1)(k+2) a_{k+2}
      - k (k-1) a_k
      - 2 k a_k
      + n(n+1) a_k
    \big] z^k \stackrel{!}{=} 0,
  \end{align*}
  which is equivalent to saying that
  \begin{equation*}
    (k+1)(k+2) a_{k+2} - k (k-1) a_k - 2 k a_k + n(n+1) a_k = 0,
  \end{equation*}
  so we can derive a recurrence relation for $a_{k+2}$:
  \begin{equation}
    \label{kugel:eqn:coeff-recursion}
    a_{k+2} = \frac{k (k-1) - 2 k + n(n+1)}{(k+1)(k+2)}a_k
    = \frac{(k-n)(k+n+1)}{(k+2)(k+1)}a_k.
  \end{equation}
  Following the relation \eqref{kugel:eqn:coeff-recursion}, if we want to
  compute $a_6$ we have
  \begin{align*}
    a_{6} = -\frac{(n-4)(n+5)}{6\cdot 5} a_4
      &= \left( -\frac{(n-4)(5+n)}{6 \cdot 5} \right)
         \left( -\frac{(n-2)(n+3)}{4 \cdot 3} \right) a_2 \\
      &= \left( -\frac{(n-4)(n+5)}{6 \cdot 5} \right)
         \left( -\frac{(n-2)(n+3)}{4 \cdot 3} \right)
         \left( -\frac{n(n+1)}{2 \cdot 1} \right)  a_0 \\
      &= -\frac{(n+5)(n+3)(n+1)n(n-2)(n-4)}{6!} a_0.
  \end{align*}
  One can generalize this relation for the $i$-th even ($i = 2k$) coefficient
  and obtain
  \begin{equation*}
    a_{2k} = (-1)^k \frac{(n+(2k-1))(n+(2k-1)-2)
      \hdots (n-(2k-2)+2)(n-(2k-2))}{(2k)!}a_0,
  \end{equation*}
  and a similar expression can also be written for the odd coefficients
  $a_{2k-1}$. In the latter case, the equation starts from $a_1$ and to find the
  pattern we can write the recursion for an odd coefficient, for example for
  $a_7$:
  \begin{align*}
    a_{7} = -\frac{(n-5)(n+6)}{7\cdot 6} a_5
      &= \left( -\frac{(n-5)(n+6)}{7 \cdot 6} \right)
         \left( -\frac{(n-3)(n+4)}{5 \cdot 4} \right) a_3 \\
      &= \left( -\frac{(n-5)(n+6)}{7 \cdot 6} \right)
         \left( -\frac{(n-3)(n+4)}{5 \cdot 4} \right)
         \left( -\frac{(n-1)(n+2)}{3 \cdot 2} \right) a_1 \\
      &= -\frac{(n+6)(n+4)(n+2)(n-1)(n-3)(n-5)}{7!} a_1.
  \end{align*}
  As before, we can generalize this equation for the $i$-th odd ($i = 2k+1$)
  coefficient and get
  \begin{equation*}
    a_{2k+1} = (-1)^k \frac{(n + 2k)(n+2k-2)
      \hdots (n-(2k-1)+2)(n-(2k-1))}{(2k+1)!} a_1.
  \end{equation*}
  Now, if we let
  \begin{align*}
    Z_\text{e}^K(z) &:=
      \sum_{k=0}^K(-1)^k \frac{
        (n+(2k-1))(n+(2k-1)-2) \hdots
        \colorbox{red!20}{$(n-(2k-2)+2)(n-(2k-2))$}
      }{(2k)!} z^{2k}, \\
    Z_\text{o}^K(z) &:=
      \sum_{k=0}^K(-1)^k \frac{
        (n + 2k)(n+2k-2)\hdots \colorbox{blue!20}{$(n-(2k-1)+2)(n-(2k-1))$}
      }{(2k+1)!} z^{2k+1},
  \end{align*}
  we have a solution to the Legendre equation \eqref{kugel:eqn:legendre-bis},
  which can be written as
  \begin{equation} \label{kugel:eqn:legendre-powerseries}
    Z(z) = \lim_{K \to \infty} \left[
      a_0 Z_\text{e}^K(z) + a_1 Z_\text{o}^K(z)
    \right].
  \end{equation}
  However, as mentioned earlier this power series only converges for $|z| < 1$,
  but (for our application in the spherical harmonics) we want convergence for
  $|z| \leq 1$. This can only happen in one case: when the power series becomes
  \emph{finite}, i.e. a polynomial. To show that this happens, we analyze the
  colored parts separately:
  \begin{itemize}
    \item[\textcolor{red!80!black}{\textbullet}]
      Suppose that $n = n_0$ is an even integer. Then in the red part, for some
      value of $k=k_0$, it will happen that
      \begin{equation*}
        n_0 = 2 k_0 - 2
        \quad \iff \quad
        n_0-(2k_0-2)=0.
      \end{equation*}
      From that point on, given the recursive nature of
      \eqref{kugel:eqn:coeff-recursion}, all the subsequent coefficients will
      also be 0, making the sum finite.

    \item[\textcolor{blue!80!black}{\textbullet}]
      Suppose that $n=n_0$ is an odd integer. Then as before, in the blue part a
      specific value of $k=k_0$ will follow the following relation:
      \begin{equation*}
        n_0 = 2k_0 - 1
        \quad \iff \quad
        n_0-(2k_0-1)=0.
      \end{equation*}
      And from that point on, for the same reason as before, all the subsequent
      coefficients will also be 0, making the sum finite.
  \end{itemize} 

  Thus, we can see that if $n \in \mathbb{Z}$ the sum will always become finite,
  which is exactly what we want. Now, whichever the case notice that the
  polynomial will always be of degree $n$. We can use this fact to write a
  single expression that contains both the odd and even cases by unfolding the
  recursion \eqref{kugel:eqn:coeff-recursion} backwards. That is, instead of
  starting with $a_0$ to compute $a_2$, or with $a_1$ to compute $a_3$ and go
  on, we use $a_n$ and go backwards and write the solution as
  \begin{equation*}
    Z(z) = a_n z^n + a_{n-2} z^{n-2} + a_{n-4} z^{n-4} 
      + a_{n-6} z^{n-6} + \hdots +
      \begin{cases} 
        a_1 z, \quad &\text{if } n \text{ is odd} \\ 
        a_0, \quad  &\text{if } n \text{ is even} 
      \end{cases}
      = \sum_{k=0}^{\lfloor n/2 \rfloor} a_{n-2k}z^{n-2k}.
  \end{equation*}
  Therefore, we need to find how to compute $a_{n - 2k}$ starting from $a_n$.
  The game is the same as before, we need to find a pattern in the coefficient calculation. We can then calculate a couple of them to see if some structure emerges
  \begin{align*}
    a_{n-2} &= -\frac{n(n-1)}{2(2n-1)}a_n, &
    a_{n-4} &= -\frac{(n-2)(n-3)}{4(2n-3)}a_{n-2}
    = \left(
        -\frac{(n-2)(n-3)}{4(2n-3)}
      \right) \left(
        -\frac{n(n-1)}{2(2n-1)}
      \right) a_n,
  \end{align*}
  and as desired, in general, we can write
  \begin{equation*}
    a_{n-2k} = (-1)^k \frac{
      n(n-1)(n-2)(n-3) \hdots (n-2k+1)
    }{
      2 \cdot 4 \cdot \hdots \cdot 2k(2n-1)(2n-3) \hdots (2n-2k+1)
    } a_n.
  \end{equation*}
  To make this expression more compact, we can start by considering the numerator, rewriting it as
  \begin{equation*}
    n(n-1)(n-2)(n-3) \hdots (n-2k+1)
    = \frac{n!}{(n-2k)!}.
  \end{equation*}
  As for the left part of the denominator, on the other hand, we have
  \begin{equation*}
    2 \cdot 4 \cdot \hdots \cdot 2k = 2^k \cdot 1 \cdot 2 \cdot 3 \cdot \hdots \cdot k = 2^k k! 
  \end{equation*}
  whereas for the remaining part:
  \begin{align*}
    (2n-1) & (2n-3) \hdots (2n-2k+1) = \frac{
        2n(2n-1)(2n-2)(2n-3) \hdots (2n-2k+1)
      }{
        2n(2n-2)(2n-4)(2n-6) \hdots (2n-2k+2)
      }
      \\
      &= \frac{
        \frac{(2n)!}{(2n-2k)!}
      }{
        2^k n(n-1)(n-2)(n-3) \hdots (n-k+1)
      }
      = \frac{
        \frac{(2n)!}{(2n-2k)!}
      }{
        2^k \frac{n!}{(n-k)!}
      }
      = \frac{(n-k)!(2n)!}{n!(2n-2k)!2^k}.
  \end{align*}
  Putting all these compact forms together, one can write $Z(x)$ as
  \begin{equation*}
    Z(x) = \sum_{k=0}^{\lfloor n / 2\rfloor}
      \underbrace{
        (-1)^k \frac{(n!)^2(2n-2k)!}{k!(n-2k)!(n-k)!(2n)!} a_n
      }_{a_{n-2k}} z^{n-2k},
  \end{equation*}
  which holds for any value of $a_n$. By letting
  \begin{equation*}
    a_{n} := \frac{(2n)!}{2^n (n!)^2},
  \end{equation*}
  the \emph{Legendre polynomials}
  \begin{equation}
    P_n(z) := \sum_{k=0}^{\lfloor n/2 \rfloor}
      (-1)^k \frac{(2n-2k)!}{2^n k! (n-k)!(n-2k)!} z^{n-2k} 
  \end{equation}
  elegantly emerges.
\end{proof}

\subsection{Associated Legendre Equation}
\label{kugel:sec:proofs:associated-legendre}

\begin{proof}[Proof of lemma \ref{kugel:thm:extend-legendre}]
  We want to show that if $Z_n(z)$ is a solution of the Legendre equation,
  \begin{equation} \label{kugel:eqn:legendre-bis}
    (1 - z^2)\frac{d^2 Z}{dz^2}
    - 2z\frac{d Z}{dz}
    + n(n + 1) Z(z) = 0,
  \end{equation}
  then
  \begin{equation*}
    Z^m_n(z) = (1 - z^2)^{m/2} \frac{d^m}{dz^m}Z_n(z)
  \end{equation*}
  solves the associated Legendre equation 
  \begin{equation*}
    (1 - z^2)\frac{d^2 Z}{dz^2}
    - 2z\frac{d Z}{dz}
    + \left( n(n + 1) - \frac{m^2}{1 - z^2} \right) Z(z) = 0.
  \end{equation*}
  To begin, we start by differentiating $m$ times \eqref{kugel:eqn:legendre-bis}
  (which is satisfied $Z(z)$), obtaining
  \begin{equation} \label{kugel:eqn:legendre-mderiv}
    \frac{d^m}{dz^m}\left[
      (1-z^2)\frac{d^2Z}{dz^2}
    \right]
    -2 \frac{d^m}{dz^m}\left[ z\frac{dZ}{dz} \right]
    + n(n+1)\frac{d^m}{dz^m}Z = 0.
  \end{equation}
  Since the notation is becoming cumbersome, we will define a new notation for
  derivatives:
  \begin{equation*}
    \frac{d}{dz} := \partial, \quad \text{and also} \quad
    \frac{d^k}{dz^k} := \partial^k.
  \end{equation*}
  \emph{Leibniz's theorem} states, that if we want to differentiate $m$ times a
  multiplication of two functions, we can use the binomial coefficients to build
  up a sum:
  \begin{equation*} %\label{kugel:eqn:leibniz}
    \partial^m \, (u \cdot v)
      = \sum_{i=0}^m \binom{n}{i} \, \partial^{m-i} u \, \partial^i v
  \end{equation*}
  By using the above in \eqref{kugel:eqn:legendre-mderiv}, we obtain
  \begin{align}
    0 &= \sum_{i=0}^m \underbrace{
      \binom{n}{i} \, \partial^{m-i} (1-z)^2 \, \partial^i Z(z)
    }_{\text{equals 0 when } m-i > 2}
    - 2 \sum_{i=0}^m \underbrace{
      \binom{n}{i} \, \partial^{m-i} z \, \partial^i Z(z)
    }_{\text{equals 0 when } m-i > 1}
    - n(n+1) \partial^m Z(z)
    \nonumber \\
    &= (1-z^2) \partial^{m+2} Z(z)
    + \partial (1-z^2) \partial^{m+1} Z(z)
    + \frac{m(m+1)}{2} \partial^2 (1-z^2) \partial^m Z(z)
    \nonumber \\
    &\qquad - 2 \left(
      z \partial^{m+1} Z(z)
      + m\partial z \partial^m Z(z)
    \right)
    + n(n+1) \partial^m Z(z)
    \nonumber \\
    &= (1-z^2) \partial^2 \partial^m Z(z)
    - 2z \partial \partial^m Z(z)
    + \bigl[ n(n + 1) - m(m-1) - 2m \bigr] \partial^m Z(z).
    \label{kugel:eqn:legendre-leibniz}
  \end{align}
  Now, we can define a new function
  \begin{equation*}
    Z^m(z) := (1-z^2)^{m/2} \partial^m Z(z)
    \quad \iff \quad
    \partial^m Z(z) = (1-z^2)^{-m/2} Z^m(z),
  \end{equation*}
  and we claim that it is a solution to the associated Legendre equation. To
  show that, we insert it in \eqref{kugel:eqn:legendre-leibniz}, which gives
  \begin{align}
    0 &= (1-z^2) \partial^2 \bigl[ (1-z^2)^{-m/2} Z^m(z) \bigr]
    - 2z\partial \bigl[ (1-z^2)^{-m/2} Z^m(z) \bigr] \nonumber \\
    &\qquad + \bigl[ n(n + 1) - m(m-1) - 2m \bigr] (1-z^2)^{-m/2} Z^m(z).
    \label{kugel:eqn:legendre-zm}
  \end{align}
  We will analyze the messy right hand side one term at the time. With a bit of
  effort one can show that
  \begin{align*}
    \partial \bigl[ (1-z^2)^{-m/2} Z^m(z) \bigr]
      &= \partial (1 - z^2)^{-m/2} Z^m(z) + (1 - z^2)^{-m/2} \partial Z^m(z) \\
      &= m(1 - z^2)^{-m/2 -1} Z^m(z) + (1 - z^2)^{-m/2} \partial Z^m(z),
  \end{align*}
  differentiating again going through quite a bit of algebra yields
  \begin{align*}
    \partial^2 \bigl[ (1-z^2)^{-m/2} Z^m(z) \bigr]
      &= \partial \bigl[ m(1-z^2)^{-(m/2)-1} Z^m(z) \bigr]
        + \partial \bigl[ (1-z^2)^{-m/2} \partial Z^m(z) \bigr] \\
      &= \partial \bigl[ m(1-z^2)^{-(m/2)} Z^m(z)
        + m(1-z^2)^{-(m/2)-1} \partial Z^m(z) \bigr] \\
        &\qquad + \bigl[ m(1-z^2)^{-(m/2)-1} \partial Z^m(z)
        + (1-z^2)^{-m/2} \partial^2 Z^m(z) \bigl] \\
      &= (1-z^2)^{-m/2-1} \partial^2 Z^m(z)
        + 2mz(1-z^2)^{-(m/2) -1} \partial Z^m(z) \\
        &\qquad + m (1-z^2)^{-(m/2)-1} Z^m(z) 
        + m z(m+2)(1-z^2)^{-m/2} Z^m(z).
  \end{align*}
  Substituting both derivatives in \eqref{kugel:eqn:legendre-zm} we obtain
  \begin{align*}
    0 = (1-z)^2 \bigg[&
      (1-z^2)^{-m/2-1} \partial^2 Z^m(z)
        + 2mz(1-z^2)^{-(m/2) -1} \partial Z^m(z)
        + m (1-z^2)^{-(m/2)-1} Z^m(z) \\
        &+ mz(m+2)(1-z^2)^{-m/2} Z^m(z)
    \bigg] -2z \left[
      m(1 - z^2)^{-m/2 -1} Z^m(z)
      + (1 - z^2)^{-m/2} \partial Z^m(z)
    \right] \\
    &+ \bigl[ n(n + 1) - m(m-1) - 2m \bigr] (1-z^2)^{-m/2} Z^m(z).
  \end{align*}
  Collecting terms and dividing by $(1-z^2)^{m/2}$, this can be simplified to
  \begin{align*}
    (1-z)^2 \partial^2 Z^m(z) &+ \left[
      2mz - 2(m+1)z
    \right] \partial Z^m(z) \\
    &+ \left[
      m + \frac{m(m+2)}{1-z^2} z^2 - \frac{m(m+1)}{1-z^2} mz^2
      + n(n+1) - m(m+1)
    \right] Z^m(z).
  \end{align*}
  Finally, simplifying the factors, which are $-2z$ for $\partial Z^m(z)$ and
  \begin{equation*}
    n(n+1) - \frac{m^2}{1-z^2},
    \qquad \text{for} \quad Z^m(z),
  \end{equation*}
  we come back to the associated Legendre equation
  \begin{equation*}
    (1 - z^2) \partial^2 Z^m
    - 2z \partial Z^m
    + \left( n(n + 1) - \frac{m^2}{1 - z^2} \right) Z^m(z) = 0,
  \end{equation*}
  which implies that $Z^m(z)$ is a solution and the proof is complete.
  \qedhere
\end{proof}

\subsection*{Bonus proof}
\begin{theorem}[Cattaneo-Pross]
  Spherical harmonics are one of the most beautiful and powerful sets of
  functions ever discovered.
\end{theorem}
\begin{proof}
  It follows directly from what is stated from section \ref{kugel:sec:intro} up to this point.
\end{proof}
