% vim:ts=2 sw=2 et spell tw=80:
\section{Long Proofs}

Here, we will give the long and tedious proofs we skipped earlier.

\subsection{Legendre Polynomials} \label{kugel:sec:proofs:legendre}

\begin{proof}[Proof of lemma \ref{kugel:thm:legendre-poly}]
  It was stated that the polynomial function
  \begin{equation*}
    P_n(z) = \sum^{\lfloor n/2 \rfloor}_{k=0}
      \frac{(-1)^k}{2^n s^k!} \frac{(2n - 2k)!}{(n - k)! (n-2k)!} z^{n - 2k}
  \end{equation*}
  is the only finite solution of the Legendre equation
  \begin{equation}
    \label{kugel:eqn:legendre-bis}
    (1 - z^2)\frac{d^2 Z}{dz^2}
    - 2z\frac{d Z}{dz}
    + n(n + 1) Z(z) = 0,
  \end{equation}
  when $n \in \mathbb{Z}$ and $z \in [-1; 1]$. In order to prove this fact, we
  begin with the power series \emph{Ansatz}
  \begin{equation*}
    Z(x) = \sum_{k=0}^\infty a_k z^k,
    \quad\text{from which follows that}\quad
    \frac{dZ}{dz} = \sum_{k=0}^\infty k a_k z^{k-1}, \qquad
    \frac{d^2 Z}{dz^2} = \sum_{k=0}^\infty k (k-1) a_k z^{k-2}.
  \end{equation*}
  Since the power series method converges only up to the nearest singularity,
  which is at $z=1$ (and $z=-1$), we shall remark that we will find a solution
  only for $|z|<1$. Using the \emph{Ansatz} the Legendre equation
  \eqref{kugel:eqn:legendre-bis} can be rewritten as
  \begin{align}
    0 &= (1-z^2) \sum_{k=0}^\infty k (k-1) a_k z^{k-2}
      - 2z\sum_{k=0}^\infty k a_k z^{k-1}
      + n(n+1)\sum_{k=0}^\infty a_k z^k \nonumber \\
    &= \sum_{k=0}^\infty k (k-1) a_k z^{k-2}
      - \sum_{k=0}^\infty k (k-1) a_k z^{k}
      - 2z\sum_{k=0}^\infty k a_k z^{k-1}
      + n(n+1)\sum_{k=0}^\infty a_k z^k. \label{kugel:eqn:legendre-ansatz}
  \end{align}
  Considers that by shifting the index $k$ in the sum of first term
  \begin{equation*}
    \sum_{k=0}^\infty k (k-1) a_k z^{k-2}
    = \sum_{k=-2}^\infty (k+2)(k+1) a_{k+2} z^k
    = \sum_{k=0}^\infty (k+2)(k+1) a_k z^k,
  \end{equation*}
  since when $k = -1$ or $-2$ the summand is zero. This means that
  \eqref{kugel:eqn:legendre-ansatz} becomes
  \begin{align*}
    \sum_{k=0}^\infty &(k+1)(k+2) a_{k+2} z^{k}
      - \sum_{k=0}^\infty k (k-1) a_k z^{k}
      - 2\sum_{k=0}^\infty k a_k z^k
      + n(n+1)\sum_{k=0}^\infty a_k z^k \nonumber \\
    &= \sum_{k=0}^\infty \big[
      (k+1)(k+2) a_{k+2}
      - k (k-1) a_k
      - 2 k a_k
      + n(n+1) a_k
    \big] z^k \stackrel{!}{=} 0,
  \end{align*}
  which is equivalent to saying that
  \begin{equation*}
    (k+1)(k+2) a_{k+2} - k (k-1) a_k - 2 k a_k + n(n+1) a_k = 0,
  \end{equation*}
  so we can derive a recurrence relation for $a_{k+2}$:
  \begin{equation}
    \label{kugel:eqn:coeff-recursion}
    a_{k+2} = \frac{k (k-1) - 2 k + n(n+1)}{(k+1)(k+2)}a_k
    = \frac{(k-n)(k+n+1)}{(k+2)(k+1)}a_k.
  \end{equation}
  Following the relation \eqref{kugel:eqn:coeff-recursion}, if we want to
  compute $a_6$ we have
  \begin{align*}
    a_{6} = -\frac{(n-4)(n+5)}{6\cdot 5} a_4
      &= \left( -\frac{(n-4)(5+n)}{6 \cdot 5} \right)
         \left( -\frac{(n-2)(n+3)}{4 \cdot 3} \right) a_2 \\
      &= \left( -\frac{(n-4)(n+5)}{6 \cdot 5} \right)
         \left( -\frac{(n-2)(n+3)}{4 \cdot 3} \right)
         \left( -\frac{n(n+1)}{2 \cdot 1} \right)  a_0 \\
      &= -\frac{(n+5)(n+3)(n+1)n(n-2)(n-4)}{6!} a_0.
  \end{align*}
  One can generalize this relation for the $i$-th even ($i = 2k$) coefficient
  and obtain
  \begin{equation*}
    a_{2k} = (-1)^k \frac{(n+(2k-1))(n+(2k-1)-2)
      \hdots (n-(2k-2)+2)(n-(2k-2))}{(2k)!}a_0,
  \end{equation*}
  and a similar expression can also be written for the odd coefficients
  $a_{2k-1}$. In the latter case, the equation starts from $a_1$ and to find the
  pattern we can write the recursion for an odd coefficient, for example for
  $a_7$:
  \begin{align*}
    a_{7} = -\frac{(n-5)(n+6)}{7\cdot 6} a_5
      &= \left( -\frac{(n-5)(n+6)}{7 \cdot 6} \right)
         \left( -\frac{(n-3)(n+4)}{5 \cdot 4} \right) a_3 \\
      &= \left( -\frac{(n-5)(n+6)}{7 \cdot 6} \right)
         \left( -\frac{(n-3)(n+4)}{5 \cdot 4} \right)
         \left( -\frac{(n-1)(n+2)}{3 \cdot 2} \right) a_1 \\
      &= -\frac{(n+6)(n+4)(n+2)(n-1)(n-3)(n-5)}{7!} a_1.
  \end{align*}
  As before, we can generalize this equation for the $i$-th odd ($i = 2k+1$)
  coefficient and get
  \begin{equation*}
    a_{2k+1} = (-1)^k \frac{(n + 2k)(n+2k-2)
      \hdots (n-(2k-1)+2)(n-(2k-1))}{(2k+1)!} a_1.
  \end{equation*}
  Now, if we let
  \begin{align*}
    Z_\text{e}^K(z) &:=
      \sum_{k=0}^K(-1)^k \frac{
        (n+(2k-1))(n+(2k-1)-2) \hdots
        \color{red!80!black}(n-(2k-2)+2)(n-(2k-2))
      }{(2k)!} z^{2k}, \\
    Z_\text{o}^K(z) &:=
      \sum_{k=0}^K(-1)^k \frac{
        (n + 2k)(n+2k-2)\hdots \color{blue!80!black} (n-(2k-1)+2)(n-(2k-1))
      }{(2k+1)!} z^{2k+1},
  \end{align*}
  we have a solution to the Legendre equation \eqref{kugel:eqn:legendre-bis},
  which can be written as
  \begin{equation} \label{kugel:eqn:legendre-powerseries}
    Z(z) = \lim_{K \to \infty} \left[
      a_0 Z_\text{e}^K(z) + a_1 Z_\text{o}^K(z)
    \right].
  \end{equation}
  However, as mentioned earlier this power series only converges for $|z| < 1$,
  but (for our application in the spherical harmonics) we want convergence for
  $|z| \leq 1$. This can only happen in one case: when the power series becomes
  \emph{finite}, i.e. a polynomial. To show that this happens, we analyze the
  colored parts separately:
  \begin{itemize}
    \item[\textcolor{red}{\textbullet}]
      Suppose that $n = n_0$ is an even integer. Then in the red part, for some
      value of $k=k_0$, it will happen that
      \begin{equation*}
        n_0-(2k_0-2)=0
        \iff
        n_0 = 2 k_0 - 2.
      \end{equation*}
      From that point on, given the recursive nature of
      \eqref{kugel:eqn:coeff-recursion}, all the subsequent coefficients will
      also be 0, making the sum finite.

    \item[\textcolor{blue}{\textbullet}]
      Suppose that $n=n_0$ is an odd integer. Then as before, in the blue part a
      specific value of $k=k_0$ will follow the following relation:
      \begin{equation*}
        n_0-(2k_0-1)=0
        \iff
        n_0 = 2k_0 - 1.
      \end{equation*}
      And from that point on, for the same reason as before, all the subsequent
      coefficients will also be 0, making the sum finite.
  \end{itemize} 

  Thus, we can see that if $n \in \mathbb{Z}$ the sum will always become finite,
  which is exactly what we want. Now, whichever the case notice that the
  polynomial will always be of degree $n$. We can use this fact to write a
  single expression that contains both the odd and even cases by unfolding the
  recursion \eqref{kugel:eqn:coeff-recursion} backwards. That is, instead of
  starting with $a_0$ to compute $a_2$, or with $a_1$ to compute $a_3$ and go
  on, we use $a_n$ and go backwards and write the solution as
  \begin{equation*}
    Z(x) = a_n x^n + a_{n-2} x^{n-2} + a_{n-4} x^{n-4} 
      + a_{n-6} x^{n-6} + \hdots +
      \begin{cases} 
        a_1 x, \quad &\text{if } n \text{ is odd} \\ 
        a_0, \quad  &\text{if } n \text{ is even} 
      \end{cases}
      = \sum_{k=0}^{\lfloor \frac{n}{2} \rfloor} a_{n-2k}x^{n-2k}.
  \end{equation*}
  Therefore, we need to find how to compute $a_{n - 2k}$ starting from $a_n$.
  The game is like before to find a pattern, so
  \begin{align*}
    a_{n-2} &= -\frac{n(n-1)}{2(2n-1)}a_n, &
    a_{n-4} &= -\frac{(n-2)(n-3)}{4(2n-3)}a_{n-2}
    = \left(
        -\frac{(n-2)(n-3)}{4(2n-3)}
      \right) \left(
        -\frac{n(n-1)}{2(2n-1)}
      \right) a_n,
  \end{align*}
  and in general 
  \begin{equation*}
    a_{n-2k} = (-1)^k \frac{
      n(n-1)(n-2)(n-3) \cdots (n-2k+1)
    }{
      2 \cdot 4 \cdots 2k(2n-1)(2n-3) \cdots (2n-2k+1)
    } a_n.
  \end{equation*}
  To clean up this expression, we use
  \begin{equation*}
    n(n-1)(n-2)(n-3) \hdots (n-2k+1)
    = \frac{n!}{(n-2k)!}
  \end{equation*}
  in the part of the denominator
  \begin{align*}
    (2n-1)(2n-3) \cdots (2n-2k+1) &= \frac{
        2n(2n-1)(2n-2)(2n-3) \cdots (2n-2k+1)
      }{
        2n(2n-2)(2n-4)(2n-6) \cdots (2n-2k+2)
      }
      \\
      &= \frac{
        \frac{(2n)!}{(2n-2k)!}
      }{
        2^k n(n-1)(n-2)(n-3) \cdots (n-k+1)
      }
      \\
      &= \frac{
        \frac{(2n)!}{(2n-2k)!}
      }{
        2^k \frac{n!}{(n-k)!}
      }
      = \frac{(n-k)!(2n)!}{n!(2n-2k)!2^k},
  \end{align*}
  and then since
  \begin{align*}
    2 \cdot 4  \cdots 2k &= 2^r 1\cdot2 \cdots r = 2^r r!,
  \end{align*}
  we obtain
  \begin{equation*}
    Z(x) = \sum_{k=0}^{\lfloor \frac{n}{2} \rfloor}
      \underbrace{
        (-1)^k \frac{n!^2(2n-2k)!}{k!(n-2k)!(n-k)!(2n)!} a_n
      }_{a_{n-2k}} z^{n-2k},
  \end{equation*}
  which holds for any value of $a_n$. By letting
  \begin{equation*}
    a_{n} := \frac{(2n)!}{2^n n!^2},
  \end{equation*}
  the \emph{Legendre polynomials}
  \begin{equation}
    P_n(z) := \sum_{k=0}^{\lfloor \frac{n}{2} \rfloor}
      (-1)^k \frac{(2n-2k)!}{2^n k! (n-k)!(n-2k)!} z^{n-2k} 
  \end{equation}
  emerges.
\end{proof}

\subsection{Associated Legendre Equation}
\label{kugel:sec:proofs:associated-legendre}

\begin{lemma}\label{kugel:lemma:sol_associated_leg_eq}
  If $Z_n(z)$ is a solution of the Legendre equation \eqref{kugel:eqn:legendre},
  then
  \begin{equation*}
    P^m_n(z) = (1 - z^2)^{m/2} \frac{d^m}{dz^m}Z_n(z)
  \end{equation*}
  solves the associated Legendre equation \eqref{kugel:eqn:associated-legendre}.
\end{lemma}
% \begin{proof} [TODO: modificare la $m$ (è già usata come costante di separazione) o forse è giusta (?)]
\begin{proof}
    To begin, we can start by differentiating $m$ times Eq.\eqref{kugel:eq:leg_eq} (which is staisfied by $y(x)$), obtaining
    \begin{equation}\label{eq:lagrange_mderiv}
    \frac{d^m}{dx^m}\left[ (1-x^2)\frac{d^2y}{dx^2} \right] -2 \frac{d^m}{dx^m}\left[ x\frac{dy}{dx} \right] + n(n+1)\frac{d^m}{dx^m}y=0.
    \end{equation}
    \emph{Leibniz's theorem} says, that if we want to differentiate $m$ times a multiplication of two functions, we can use the binomial coefficients to build up a sum. This allows us to be more compact, obtaining 
    \begin{equation}\label{eq:leibniz}
    \frac{d^m}{dx^m}[u(x)v(x)] = \sum_{i=0}^m \binom{n}{i} \frac{d^{m-i}u}{dx^{m-1}} \frac{d^{i}v}{dx^i}.
    \end{equation}
    Using Eq.\eqref{eq:leibniz} in Eq.\eqref{eq:lagrange_mderiv}, we have
    \begin{align}
    (1-x^2)\frac{d^{m+2}y}{dx^{m+2}} &+ m \frac{d}{dx}(1-x^2)\frac{d^{m+1}y}{dx^{m+1}} + \frac{m(m-1)}{2}\frac{d^{2}}{dx^{2}}(1-x^2)\frac{d^{m}y}{dx^{m}} + n(n+1)\frac{d^m{}y}{dx^{m}} \nonumber \\
    &-2\left(x\frac{d^{m+1}y}{dx^{m+1}} + m\frac{d}{dx}x\frac{d^{m}y}{dx^{m}} \right) \nonumber \\
    &= (1-x^2)\frac{d^{m+2}y}{dx^{m+2}} -2x(m+1)\frac{d^{m+1}y}{dx^{m+1}}+(n(n+1)-m(m-1)-2m)\frac{d^{m}y}{dx^{m}}=0. \label{eq:aux_3}
    \end{align}
    To make the notation easier to follow, a new function can be defined
    \begin{equation*}
    \frac{d^{m}y}{dx^{m}} := y_m.
    \end{equation*}
    Eq.\eqref{eq:aux_3} now becomes
    \begin{equation}\label{eq:1st_subs}
    (1-x^2)\frac{d^{2}y_m}{dx^{2}} -2x(m+1)\frac{dy_m}{dx}+(n(n+1)-m(m+1))y_m=0
    \end{equation}
    A second function can be further defined as
    \begin{equation*}
    (1-x^2)^{\frac{m}{2}}\frac{d^{m}y}{dx^{m}} = (1-x^2)^{\frac{m}{2}}y_m := \hat{y}_m,
    \end{equation*}
    allowing to write Eq.\eqref{eq:1st_subs} as
    \begin{equation}\label{eq:2st_subs}
    (1-x^2)\frac{d^2}{dx^2}[\hat{y}_m(1-x^2)^{-\frac{m}{2}}] -2(m+1)x\frac{d}{dx}[\hat{y}_m(1-x^2)^{-\frac{m}{2}}] + (n(n+1)-m(m+1))\hat{y}_m(1-x^2)^{-\frac{m}{2}}=0.
    \end{equation}
    The goal now is to compute the two terms 
    \begin{align*}
    \frac{d^2}{dx^2}[\hat{y}_m(1-x^2)^{-\frac{m}{2}}] &=  \frac{d^2\hat{y}_m}{dx^2} (1-x^2)^{-\frac{m}{2}} + \frac{d\hat{y}_m}{dx}\frac{m}{2}(1-x^2)^{-\frac{m}{2}-1}2x \\
    &+ m\left( \frac{d\hat{y}_m}{dx} x (1-x^2)^{-\frac{m}{2}-1} + \hat{y}_m (1-x^2)^{-\frac{m}{2}-1} - \hat{y}_m x (-\frac{m}{2}-1)(1-x^2)^{-\frac{m}{2}} 2x\right) \\
    &= \frac{d^2\hat{y}_m}{dx^2} (1-x^2)^{-\frac{m}{2}} + \frac{d\hat{y}_m}{dx}mx (1-x^2)^{-\frac{m}{2}-1} + m\frac{d\hat{y}_m}{dx}x (1-x^2)^{-\frac{m}{2}-1}\\
    &+ m\hat{y}_m  (1-x^2)^{-\frac{m}{2}-1} + m\hat{y}_m x^2(m+2)(1-x^2)^{-\frac{m}{2}-2}
    \end{align*}
    and
    \begin{align*}
    \frac{d}{dx}[\hat{y}_m(1-x^2)^{-\frac{m}{2}}] &= \frac{d\hat{y}_m}{dx}(1-x^2)^{-\frac{m}{2}} + \hat{y}_m\frac{m}{2}(1-x^2)^{-\frac{m}{2}-1}2x \\
    &= \frac{d\hat{y}_m}{dx}(1-x^2)^{-\frac{m}{2}} + \hat{y}_mm(1-x^2)^{-\frac{m}{2}-1}x,
    \end{align*}
    to use them in Eq.\eqref{eq:2st_subs}, obtaining
    \begin{align*}
    (1-x^2)\biggl[\frac{d^2\hat{y}_m}{dx^2} (1-x^2)^{-\frac{m}{2}} &+ \frac{d\hat{y}_m}{dx}mx (1-x^2)^{-\frac{m}{2}-1} + m\frac{d\hat{y}_m}{dx}x (1-x^2)^{-\frac{m}{2}-1} \\ 
    &+ m\hat{y}_m  (1-x^2)^{-\frac{m}{2}-1} + m\hat{y}_m x^2(m+2)(1-x^2)^{-\frac{m}{2}-2}\biggr] \\
    &-2(m+1)x\left[  \frac{d\hat{y}_m}{dx}(1-x^2)^{-\frac{m}{2}} + \hat{y}_mm(1-x^2)^{-\frac{m}{2}-1}x \right] \\
    &+ (n(n+1)-m(m+1))\hat{y}_m(1-x^2)^{-\frac{m}{2}}=0.\\
    \end{align*}
    We can now divide by $(1-x^2)^{-\frac{m}{2}}$, obtaining
    \begin{align*}
    (1-x^2)\biggl[\frac{d^2\hat{y}_m}{dx^2} &+ \frac{d\hat{y}_m}{dx}mx (1-x^2)^{-1} + m\frac{d\hat{y}_m}{dx}x (1-x^2)^{-1} + m\hat{y}_m  (1-x^2)^{-1} + m\hat{y}_m x^2(m+2)(1-x^2)^{-2}\biggr] \\
    &-2(m+1)x\left[  \frac{d\hat{y}_m}{dx} + \hat{y}_mm(1-x^2)^{-1}x \right] + (n(n+1)-m(m+1))\hat{y}_m\\
    &= \frac{d^2\hat{y}_m}{dx^2} + \frac{d\hat{y}_m}{dx}mx + m\frac{d\hat{y}_m}{dx}x + m\hat{y}_m + m\hat{y}_m x^2(m+2)(1-x^2)^{-1} \\
    &-2(m+1)x\left[  \frac{d\hat{y}_m}{dx} + \hat{y}_mm(1-x^2)^{-1}x \right] + (n(n+1)-m(m+1))\hat{y}_m\\
    \end{align*}
    and collecting some terms
    \begin{equation*}
    (1-x^2)\frac{d^2\hat{y}_m}{dx^2} - 2x\frac{d\hat{y}_m}{dx} + \left( -x^2 \frac{m^2}{1-x^2} + m+n(n+1)-m(m+1)\right)\hat{y}_m=0.
    \end{equation*}
    Showing that 
    \begin{align*}
    -x^2 \frac{m^2}{1-x^2} + m+n(n+1)-m(m+1) &= n(n+1)- m^2 -x^2 \frac{m^2}{1-x^2} \\
    &= n(n+1)- \frac{m}{1-x^2}
    \end{align*}
    implies $\hat{y}_m(x)$ being a solution of Eq.\eqref{kugel:eq:associated_leg_eq}
\end{proof}

\subsection{Orthogonality}
