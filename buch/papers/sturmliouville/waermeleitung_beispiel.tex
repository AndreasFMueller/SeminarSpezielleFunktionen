%
% waermeleitung_beispiel.tex -- Beispiel Wärmeleitung in homogenem Stab. 
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%

\subsection{Wärmeleitung in einem Homogenen Stab}

In diesem Abschnitt betrachten wir das Problem der Wärmeleitung in einem
homogenen Stab und wie das Sturm-Liouville-Problem bei der Beschreibung dieses
physikalischen Phänomenes auftritt.

Zunächst wird ein eindimensionaler homogener Stab der Länge $l$ und
Wärmeleitkoeffizient $\kappa$.
Somit ergibt sich für das Wärmeleitungsproblem
die partielle Differentialgleichung
\begin{equation}
    \label{eq:slp-example-fourier-heat-equation}
    \frac{\partial u}{\partial t} =
    \kappa \frac{\partial^{2}u}{{\partial x}^{2}}
\end{equation}
wobei der Stab in diesem Fall auf der X-Achse im Intervall $[0,l]$ liegt.

Da diese Differentialgleichung das Problem allgemein für einen homogenen
Stab beschreibt, werden zusätzliche Bedingungen benötigt, um beispielsweise
die Lösung für einen Stab zu finden, bei dem die Enden auf konstanter 
Tempreatur gehalten werden.

%%%%%%%%%%%%% Randbedingungen für Stab mit konstanten Endtemperaturen %%%%%%%%%

\subsubsection{Stab mit Enden auf konstanter Temperatur}

Die Enden des Stabes auf konstanter Temperatur zu halten bedeutet, dass die
Lösungsfunktion $u(t,x)$ bei $x = 0$ und $x = l$ nur die vorgegebene
Temperatur zurückgeben darf.
Es folgen nun
\begin{equation}
    \label{eq:slp-example-fourier-boundary-condition-ends-constant}
    u(t,0)
    =
    u(t,l)
    =
    0
\end{equation}
als Randbedingungen.

%%%%%%%%%%%%% Randbedingungen für Stab mit isolierten Enden %%%%%%%%%%%%%%%%%%%

\subsubsection{Stab mit isolierten Enden}

Bei isolierten Enden des Stabes können belibige Temperaturen für $x = 0$ und
$x = l$ auftreten. In diesem Fall nicht erlaubt ist es, dass Wärme vom Stab
an die Umgebung oder von der Umgebung an den Stab abgegeben wird.

Aus der Physik ist bekannt, dass Wärme immer von der höheren zur tieferen
Temperatur fliesst. Um Wärmefluss zu unterdrücken, muss also dafür gesorgt
werden, dass am Rand des Stabes keine Temperaturdifferenz existiert oder 
dass die partiellen Ableitungen von $u(t,x)$ nach $x$ bei $x = 0$ und $x = l$
verschwinden.
Somit folgen
\begin{equation}
    \label{eq:slp-example-fourier-boundary-condition-ends-isolated}
    \frac{\partial}{\partial x} u(t, 0)
    =
    \frac{\partial}{\partial x} u(t, l)
    =
    0
\end{equation}
als Randbedingungen.

%%%%%%%%%%% Lösung der Differenzialgleichung %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Lösung der Differenzialgleichung}

% TODO: Referenz Separationsmethode
% TODO: Formeln sauber in Text einbinden.

Da die Lösungsfunktion von zwei Variablen abhängig ist, wird als Lösungsansatz
die Separationsmethode verwendet.
Dazu wird 
\[
    u(t,x)
    =
    T(t)X(x)
\]
in die ursprüngliche Differenzialgleichung eingesetzt.
Daraus ergibt sich 
\[
    T^{\prime}(t)X(x)
    =
    \kappa T(t)X^{\prime \prime}(x)
\]
als neue Form.

Nun können alle von $t$ abhängigen Ausdrücke auf die linke Seite, sowie alle
von $x$ abhängigen Ausdrücke auf die rechte Seite gebracht werden und mittels
der neuen Variablen $\mu$ gekoppelt werden:
\begin{equation}
    \frac{T^{\prime}(t)}{\kappa T(t)}
    =
    \frac{X^{\prime \prime}(x)}{X(x)}
    =
    \mu
\end{equation}
Durch die Einführung von $\mu$ kann das Problem nun in zwei separate
Differenzialgleichungen aufgeteilt werden:
\begin{equation}
    \label{eq:slp-example-fourier-separated-x}
    X^{\prime \prime}(x) - \mu X(x)
    =
    0
\end{equation}
\begin{equation}
    \label{eq:slp-example-fourier-separated-t}
    T^{\prime}(t) - \kappa \mu T(t)
    =
    0
\end{equation}

Es ist an dieser Stelle zu bemerken, dass die Gleichung in $x$ in 
Sturm-Liouville-Form ist.
Erfüllen die Randbedingungen des Stab-Problems auch die Randbedingungen des
Sturm-Liouville-Problems, kann bereits die Aussage getroffen werden, dass alle
Lösungen für die Gleichung in $x$ orthogonal sein werden.

Damit die Lösungen von $X$ orthogonal sind, müssen also die Gleichungen
\begin{equation}
\begin{aligned}
	\label{eq:slp-example-fourier-randbedingungen}
	k_a y(a) + h_a p(a) y'(a) &= 0 \\
	k_b y(b) + h_b p(b) y'(b) &= 0
\end{aligned}
\end{equation}
erfüllt sein und es muss ausserdem
\begin{equation}
\begin{aligned}
    \label{eq:slp-example-fourier-coefficient-constraints}
    |k_a|^2 + |h_a|^2 &\neq 0\\
    |k_b|^2 + |h_b|^2 &\neq 0\\
\end{aligned}
\end{equation}
gelten.

Um zu verifizieren, ob die Randbedingungen erfüllt sind, benötigen wir zunächst
$p(x)$.
Dazu wird die Gleichung \eqref{eq:slp-example-fourier-separated-x} mit der
Sturm-Liouville-Form \eqref{eq:sturm-liouville-equation} verglichen, was zu
$p(x) = 1$ führt.

Werden nun $p(x)$ und die Randbedingungen
\eqref{eq:slp-example-fourier-boundary-condition-ends-constant} in
\eqref{eq:slp-example-fourier-randbedingungen} eigesetzt, erhält man
\[
\begin{aligned}
	k_a y(0) + h_a y'(0) &= h_a y'(0) = 0 \\
	k_b y(l) + h_b y'(l) &= h_b y'(l) = 0.
\end{aligned}
\]
Damit die Gleichungen erfüllt sind, müssen $h_a = 0$ und $h_b = 0$ sein.
Zusätzlich müssen aber die Bedingungen 
\eqref{eq:slp-example-fourier-coefficient-constraints} erfüllt sein und
da $y(0) = 0$ und $y(l) = 0$ sind, können belibige $k_a \neq 0$ und $k_b \neq 0$
gewählt werden.

Somit ist gezeigt, dass die Randbedingungen des Stab-Problems für Enden auf
konstanter Temperatur auch die Sturm-Liouville-Randbedingungen erfüllen und
alle daraus reultierenden Lösungen orthogonal sind.
Analog dazu kann gezeit werden, dass die Randbedingungen für einen Stab mit
isolierten Enden ebenfalls die Sturm-Liouville-Randbedingungen erfüllen und
somit auch zu orthogonalen Lösungen führen.

Widmen wir uns zunächst der ersten Gleichung.
Aufgrund der Struktur der Gleichung
\[
    X^{\prime \prime}(x) - \mu X(x)
    =
    0
\]
wird ein trigonometrischer Ansatz gewählt.
Die Lösungen für $X(x)$ sind also von der Form
\[
    X(x)
    =
    A \sin \left( \alpha x\right) + B \cos \left( \beta x\right).
\]

Dieser Ansatz wird nun solange differenziert, bis alle in Gleichung 
\eqref{eq:slp-example-fourier-separated-x} enthaltenen Ableitungen vorhanden
sind.
Man erhält also
\[
    X^{\prime}(x)
    =
    \alpha A \cos \left( \alpha x \right) -
    \beta B \sin \left( \beta x \right)
\]
und
\[
    X^{\prime \prime}(x)
    =
    -\alpha^{2} A \sin \left( \alpha x \right) -
    \beta^{2} B \cos \left( \beta x \right).
\]

Eingesetzt in Gleichung \eqref{eq:slp-example-fourier-separated-x} ergibt dies
\[
    -\alpha^{2}A\sin(\alpha x) - \beta^{2}B\cos(\beta x) -
    \mu\left(A\sin(\alpha x) + B\cos(\beta x)\right)
    =
    0
\]
und durch umformen somit
\[
    -\alpha^{2}A\sin(\alpha x) - \beta^{2}B\cos(\beta x)
    =
    \mu A\sin(\alpha x) + \mu B\cos(\beta x).
\]

Durch Koeffizientenvergleich von
\[
\begin{aligned}
    -\alpha^{2}A\sin(\alpha x)
    &=
    \mu A\sin(\alpha x)
    \\
    -\beta^{2}B\cos(\beta x)
    &=
    \mu B\cos(\beta x)
\end{aligned}
\]
ist schnell ersichtlich, dass $ \mu = -\alpha^{2} = -\beta^{2} $ gelten muss für
$ A \neq 0 $ oder $ B \neq 0 $.
Zur Berechnung von $ \mu $ bleiben also noch  $ \alpha $ und $ \beta $ zu
bestimmen.
Dazu werden nochmals die Randbedingungen
\eqref{eq:slp-example-fourier-boundary-condition-ends-constant} und
\eqref{eq:slp-example-fourier-boundary-condition-ends-isolated} benötigt.
Zu bemerken ist, dass die Randbedingungen nur Anforderungen in $x$ stellen und
somit direkt für $X(x)$ übernomen werden können.

Daraus ergibt sich für einen Stab mit Enden auf konstanter Temperatur

\begin{equation}
    \label{eq:slp-example-fourier-mu-solution}
    \mu
    =
    -\frac{n^{2}\pi^{2}}{l^{2}}
\end{equation}

Betrachten wir nun die zweite Gleichung der Separation
\eqref{eq:slp-example-fourier-separated-t}.
Diese Lösen wir über das charakteristische Polynom
\[
    \lambda - \kappa \mu
    =
    0.
\]
Es ist direkt ersichtlich, dass $\lambda = \kappa \mu$ gelten muss, was zur
Lösung
\[
    T(t)
    =
    e^{-\kappa \mu t}
\]
führt.
Und mit dem Resultat \eqref{eq:slp-example-fourier-mu-solution} die Lösung
\[
    T(t)
    =
    e^{-\frac{n^{2}\pi^{2}\kappa}{l^{2}}t}
\]
ergibt.

% TODO: Rechenweg
TODO: Rechenweg... Enden auf konstanter Temperatur:
\[
\begin{aligned}
    u(t,x)
    &=
    \sum_{n=1}^{\infty}a_{n}e^{-\frac{n^{2}\pi^{2}\kappa}{l^{2}}t}
    \sin\left(\frac{n\pi}{l}x\right)
    \\
    a_{n}
    &=
    \frac{2}{l}\int_{0}^{l}u(0,x)sin\left(\frac{n\pi}{l}x\right) dx
\end{aligned}
\]

TODO: Rechenweg... Enden isoliert:
\[
\begin{aligned}
    u(t,x)
    &=
    a_{0} + \sum_{n=1}^{\infty}a_{n}e^{-\frac{n^{2}\pi^{2}\kappa}{l^{2}}t}
    \cos\left(\frac{n\pi}{l}x\right)
    \\
    a_{0}
    &=
    \frac{1}{l}\int_{0}^{l}u(0,x) dx
    \\
    a_{n}
    &=
    \frac{2}{l}\int_{0}^{l}u(0,x)sin\left(\frac{n\pi}{l}x\right) dx
\end{aligned}
\]
