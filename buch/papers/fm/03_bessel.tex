%
% teil2.tex -- Beispiel-File für teil2 
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\section{FM und Bessel-Funktion 
\label{fm:section:proof}}
\rhead{Herleitung}
Die momentane Trägerkreisfrequenz \(\omega_i\), wie schon in (ref) beschrieben ist, bringt die Ableitung \(\frac{d \varphi(t)}{dt}\) mit sich.
Diese wiederum kann durch \(\beta\sin(\omega_mt)\) ausgedrückt werden, wobei es das modulierende Signal \(m(t)\) ist.
Somit haben wir unser \(x_c\) welches 
\[
\cos(\omega_c t+\beta\sin(\omega_mt))
\]
ist.

\subsection{Herleitung}
Das Ziel ist, unser moduliertes Signal mit der Bessel-Funktion so auszudrücken:
\begin{align}
    x_c(t)
    = 
    \cos(\omega_ct+\beta\sin(\omega_mt))
    &=
    \sum_{k= -\infty}^\infty J_{k}(\beta) \cos((\omega_c+k\omega_m)t)
    \label{fm:eq:proof}
\end{align}

\subsubsection{Hilfsmittel}
Doch dazu brauchen wir die Hilfe der Additionsthoerme 
\begin{align}
    \cos(A + B) 
    &= 
    \cos(A)\cos(B)-\sin(A)\sin(B)
    \label{fm:eq:addth1}
    \\
    2\cos (A)\cos (B)
    &=
    \cos(A-B)+\cos(A+B)
    \label{fm:eq:addth2}
    \\
    2\sin(A)\sin(B)
    &=
    \cos(A-B)-\cos(A+B)
    \label{fm:eq:addth3}
\end{align}
und die drei Bessel-Funktionsindentitäten,
\begin{align}
    \cos(\beta\sin\phi)
    &=
    J_0(\beta) + 2\sum_{k=1}^\infty J_{2k}(\beta) \cos(2k\phi)
    \label{fm:eq:besselid1}
    \\
    \sin(\beta\sin\phi)
    &=
    2\sum_{k=0}^\infty J_{2k+1}(\beta) \cos((2k+1)\phi)
    \label{fm:eq:besselid2}
    \\
    J_{-n}(\beta) &= (-1)^n J_n(\beta)
    \label{fm:eq:besselid3}
\end{align}
welche man im Kapitel \eqref{buch:fourier:eqn:expinphireal}, \eqref{buch:fourier:eqn:expinphiimaginary}, \eqref{buch:fourier:eqn:symetrie} findet.

\subsubsection{Anwenden des Additionstheorem}
Mit dem \eqref{fm:eq:addth1} wird aus dem modulierten Signal
\[
    x_c(t) 
    =
    \cos(\omega_c t + \beta\sin(\omega_mt))
    =
    \cos(\omega_c t)\cos(\beta\sin(\omega_m t)) - \sin(\omega_ct)\sin(\beta\sin(\omega_m t)).
    \label{fm:eq:start}
\]
%-----------------------------------------------------------------------------------------------------------
\subsubsection{Cos-Teil}
Zu beginn wird der Cos-Teil
\begin{align*}
    c(t) 
    &=
    \cos(\omega_c t)\cdot\cos(\beta\sin(\omega_mt))  
\end{align*}
mit hilfe der Besselindentität \eqref{fm:eq:besselid1} zum
\begin{align*}
    c(t)
    &=
    \cos(\omega_c t) \cdot \bigg[ J_0(\beta) + 2\sum_{k=1}^\infty J_{2k}(\beta) \cos( 2k \omega_m t)\, \bigg]
    \\
    &=
    J_0(\beta) \cdot \cos(\omega_c t) + \sum_{k=1}^\infty J_{2k}(\beta) \underbrace{2\cos(\omega_c t)\cos(2k\omega_m t)}_{\text{Additionstheorem \eqref{fm:eq:addth2}}}
\end{align*}
%intertext{}   Funktioniert nicht.
wobei mit dem Additionstheorem \eqref{fm:eq:addth2} \(A = \omega_c t\) und \(B = 2k\omega_m t \) ersetzt wurden.
Nun kann die Summe in zwei Summen 
\begin{align*}
    c(t)
    &=
    J_0(\beta) \cdot \cos(\omega_c t) + \sum_{k=1}^\infty J_{2k}(\beta) \cos((\omega_c - 2k \omega_m) t) \,+\, \cos((\omega_c + 2k \omega_m) t) \}
    \\
    &=
    \sum_{k=\infty}^{1} J_{2k}(\beta)  \underbrace{\cos((\omega_c - 2k \omega_m) t)} 
    \,+\,J_0(\beta)\cdot \cos(\omega_c t) 
    \,+\, \sum_{k=1}^\infty J_{2k}(\beta)\cos((\omega_c + 2k \omega_m) t) 
\end{align*}
aufgeteilt werden.
Wenn bei der ersten Summe noch \(k\) von \(-\infty \to -1\) läuft, wird diese summe zu \(\sum_{k=-1}^{-\infty} J_{-2k}(\beta)  {\cos((\omega_c + 2k \omega_m) t)} \)
Zudem kann die Besselindentität \eqref{fm:eq:besselid3} gebraucht werden.  \(n \) wird  mit \(2k\) ersetzt, da dies immer gerade ist so gilt: \(J_{-n}(\beta) = J_n(\beta)\)
Somit bekommt man zwei gleiche Summen
\begin{align*}
    c(t)
    &=
    \sum_{k=-\infty}^{-1} J_{2k}(\beta) \cos((\omega_c + 2k \omega_m) t)
    \,+\,J_0(\beta)\cdot \cos(\omega_c t+ 2 \cdot 0 \omega_m) 
    \,+\, \sum_{k=1}^\infty J_{2k}(\beta)\cos((\omega_c + 2k \omega_m) t) 
\end{align*}
Diese können wir vereinfachter schreiben,
\begin{align*}
    \sum_{n\, \text{gerade}} J_{n}(\beta) \cos((\omega_c + n \omega_m) t),
    \label{fm:eq:gerade}
\end{align*}
da \(2k\) für alle negativen, wie positiven geraden Zahlen zählt.
%----------------------------------------------------------------------------------------------------------------
\subsubsection{Sin-Teil}
Nun zum zweiten Teil des Term \eqref{fm:eq:start}, den Sin-Teil
\begin{align*}
    s(t) 
    &=
    -\sin(\omega_c t)\cdot\sin(\beta\sin(\omega_m t)).
\end{align*}
Dieser wird mit der \eqref{fm:eq:besselid2} Besselindentität zu
\begin{align*}
    s(t) 
    &=
    -\sin(\omega_c t) \cdot \bigg[ 2 \sum_{k=0}^\infty J_{ 2k + 1}(\beta) \cos(( 2k + 1) \omega_m t) \bigg]
    \\
    &=
    \sum_{k=0}^\infty -1 \cdot J_{2k+1}(\beta) 2\sin(\omega_c t)\cos((2k+1)\omega_m t).
\end{align*}
Da \(2k + 1\) alle ungeraden positiven Ganzzahlen entspricht wird es durch \(n\) ersetzt. 
Wird die Besselindentität \eqref{fm:eq:besselid3} gebraucht, so ersetzten wird \(J_{-n}(\beta) = -1\cdot J_n(\beta)\) ersetzt:
\begin{align*}
    s(t)
    &=
    \sum_{n=0}^\infty J_{-n}(\beta) \underbrace{2\sin(\omega_c t)\cos(n \omega_m t)}_{\text{Additionstheorem \eqref{fm:eq:addth3}}}.
\end{align*}
Auch hier wird ein Additionstheorem \eqref{fm:eq:addth3} gebraucht, dabei ist \(A = \omega_c t\) und \(B = n \omega_m t \), 
somit wird daraus:
\begin{align*}
    s(t)
    &=
    \sum_{n=0}^\infty J_{-n}(\beta) \{ \underbrace{\cos((\omega_c - n\omega_m) t)} \,-\, \cos((\omega_c + n\omega_m) t) \}
    \\
    &=
   \sum_{n=- \infty}^{0} J_{n}(\beta)  \overbrace{\cos((\omega_c + n \omega_m) t)}
   \,-\, \sum_{n=0}^\infty J_{-n}(\beta) \cos((\omega_c + n\omega_m) t)
\end{align*}
Auch hier wurde wieder eine zweite Summe \(\sum_{-\infty}^{-1}\) gebraucht um das Minus zu einem Plus zu wandeln.
Wenn \(n = 0 \) ist der Minuend gleich dem Subtrahend und somit dieser Teil \(=0\), das bedeutet \(n\) ended bei \(-1\) und started bei \(1\).
\begin{align*}
    s(t)
    &=
    \sum_{n=- \infty}^{-1} J_{n}(\beta)  \cos((\omega_c + n \omega_m) t)
    \underbrace{\,-\, \sum_{n=1}^\infty J_{-n}(\beta)} \cos((\omega_c + n\omega_m) t)
\end{align*}
Um aus diesem Subtrahend eine Addition zu kreiernen, wird die Besselindentität \eqref{fm:eq:besselid3} gebraucht, 
jedoch so \(-1 \cdot J_{-n}(\beta) = J_n(\beta)\) und daraus wird dann:
\begin{align*}
    s(t)
    &=
    \sum_{n=- \infty}^{-1} J_{n}(\beta)  \cos((\omega_c + n \omega_m) t)
    \,+\, \sum_{n=1}^\infty J_{n}(\beta) \cos((\omega_c + n\omega_m) t)
\end{align*}
Da \(n\) immer ungerade ist und \(0\) nicht zu den ungeraden Zahlen zählt, kann man dies so vereinfacht 
\[
    s(t)
    =
    \sum_{n\, \text{ungerade}} J_{n}(\beta) \cos((\omega_c + n\omega_m) t).
    \label{fm:eq:ungerade}
\]
, mit allen positiven und negativen Ganzzahlen schreiben.
%------------------------------------------------------------------------------------------
\subsubsection{Summe Zusammenführen}
Beide Teile \eqref{fm:eq:gerade} Gerade 
\[
    \sum_{n\, \text{gerade}} J_{n}(\beta) \cos((\omega_c + n\omega_m) t)
\]
und \eqref{fm:eq:ungerade} Ungerade 
\[
    \sum_{n\, \text{ungerade}} J_{n}(\beta) \cos((\omega_c + n\omega_m) t)
\]
ergeben zusammen
\[
    \cos(\omega_ct+\beta\sin(\omega_mt))
    =
    \sum_{k= -\infty}^\infty J_{n}(\beta) \cos((\omega_c+ n\omega_m)t).
\]
Somit ist \eqref{fm:eq:proof} bewiesen.
\newpage
%-----------------------------------------------------------------------------------------
\subsection{Bessel und Frequenzspektrum}
Unser FM-signal Fourientransformiert \eqref{fm:FM:fourie} wird zusammengestzt aus den einzelen Reihenteilen mit der gewichtung der Besselfunktion.


Nochmals zur erinnerung sah unser Träger Signal anfangs so aus:
\(x_c(t) = A_c \cdot \cos(\omega_c(t)+\varphi)\), dabei modulierten wir den parameter \( \varphi = \beta\sin(\omega_mt) \).
Davon sahen wir das sich ursprünglich unser Signal\(m_{FM}(t) = \cos(\omega_m t)\) war. 
Wie das Beat zusammenhängt sieht man im Abschnitt ( ref). 
Wird es weiter transformiert zur Summe, so erhält man ein
\[
    x_{FM} = 
    \sum_{k= -\infty}^\infty J_{n}(\beta) \cos((\omega_c+ n\omega_m)t).
\]
Diese Summe nun Fourier Transformiert ergibt
\[
    x_{FM} = 
    \sum_{k= -\infty}^\infty J_{n}(\beta) \cdot \frac{1}{2} \biggl(  e^{j(\omega_c+ n\omega_m)t}\;+\; e^{-j(\omega_c+ n\omega_m)t}\biggr).
\]
Dies ergibt wiederum zwei dirac impulse im Frequenzbereich, aber pro Summand mit der Gewichtung der Besselfunktion indices und deren \(\beta\). 
Gegeneüber \textit{AM} hat sich \textit{FM} zu einer Summe mit gewichtungen der Besselfunktion verändert.
Überall wo die Besselfunktion gegn 0 tendiert können wir diese Summand vernachlässigen.
Um dies zu sehn plotten wir einmal \(J_{n}(\beta)\):
\begin{figure}
	\centering
	\input{papers/fm/Python animation/bessel.pgf}
	\caption{Bessle Funktion \(J_{n}(\beta)\)}
	\label{fig:bessel}
\end{figure}
Hier sieht man gut das für kleine \( \beta \lessgtr \) nur die ersten Summanden \( n\) zuständig sind.
So kann man mit dem \(\beta\) gut bestimmen bis wo die Summe berchnet werden soll. 

Für ein Beispiel nehmen wir  \(\beta = ... \omega_m = ... \)
Dann sieht unser \(x_{FM}\) so aus:
\begin{figure}
	\centering
	
	\caption{Beispiel eines FM Übertragenen Signal}
	\label{fig:bessel}
\end{figure}
Nun verändern wir die drei Parameter \(\beta \omega_c \omega_m \) und sehen was sich verändern wird
\subsubsection{Beta}
Da \(\beta\) in keiner abhängigkeit zo den anderen parameter steht, und jegliglich die anzahl der nötigen Summanden bestimmt.
So wird es auch diese Anzahl bestimmen was man hier sehen kann.
\subsubsection{omega c}
Dieser ist unser Trägerfrequenz auf die unser Signal aufmoduliert wurde, diese bestimmt die Frequenz in welchem sich das signal befindet
\subsubsection{omega m}
Dieser parametr hat unsere bandbreite auf welchem unser Moduliertes Signal \(x_{AM}\) befindet bestimmt, auch im FM wird es wieder die Bandbreite bestimmen, was wir hier sehen.

Nun einmal das Modulierte FM signal mit dem \(\beta =  \omega_m =  \) berechnet:



TODO
Hier wird beschrieben wie die Bessel Funktion der FM im Frequenzspektrum hilft, wieso diese gebrauch wird und ihre Vorteile.
\begin{itemize}
    \item Zuerest einmal die Herleitung von FM zu der Bessel-Funktion
    \item Im Frequenzspektrum darstellen mit Farben, ersichtlich machen. 
    \item Parameter tuing der Trägerfrequenz, Modulierende frequenz und Beta. 
\end{itemize}
\newpage


%\subsection{De finibus bonorum et malorum
%\label{fm:subsection:bonorum}}



