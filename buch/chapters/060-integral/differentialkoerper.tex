%
% differentialalgebren.tex
%
% (c) 2021 Prof Dr Andreas Müller, OST Ostschweizer Fachhochschule
%
\section{Differentialkörper und der Satz von Liouville
\label{buch:integrale:section:dkoerper}}
\rhead{Differentialkörper und der Satz von Liouville}
Das Problem der Darstellbarkeit eines Integrals in geschlossener
Form verlangt zunächst einmal nach einer Definition dessen, was man
als ``geschlossene Form'' akzeptieren will.
Die sogenannten {\em elementaren Funktionen} von
Abschnitt~\ref{buch:integrale:section:elementar}
bilden dafür den theoretischen Rahmen.
Das Problem ist dann die Frage zu beantworten, ob ein Integral eine
Stammfunktion hat, die eine elementare Funktion ist.
Der Satz von Liouville von Abschnitt~\ref{buch:integrale:section:liouville}
löst das Problem.

\subsection{Eine Analogie
\label{buch:integrale:section:analogie}}
% XXX Analogie: Formel für Polynom-Nullstellen 
% XXX           Stammfunktion als elementare Funktion
Das Analysis-Problem, eine Stammfunktion zu finden, ist analog zum
wohlbekannten algebraischen Problem, Nullstellen von Polynomen zu finden.
Wir entwickeln diese Analogie in etwas mehr Detail, um zu sehen, ob man
aus dem algebraischen Problem etwas über das Problem der Analysis
lernen kann.

Für ein Polynom $p(X) = a_nX^n+a_{n-1}X^{n-1}+\dots+a_1X+a_0\in\mathbb{C}[X]$
mit Koeffizienten $a_k\in\mathbb{C}$ ist es sehr einfach, für jede beliebige
komplexe Zahl $z\in\mathbb{C}$ den Wert $p(z)$ des Polynoms auszurechnen.
Ein paar wenige Rechenregeln genügen dazu, man kann leicht einem Kind 
beibringen, mit einem Taschenrechner so einen Wert auszurechnen.

Ähnlich sieht es mit der Ableitungsoperation aus. 
Einige wenige Ableitungsregeln, die man in der Analysis~I lernt,
erlauben, auf mehr oder weniger mechanische Art und Weise, jede
beliebige Funktion abzuleiten.
Man kann auch leicht einen Computer dazu programmieren, solche Ableitungen
symbolisch zu berechnen.

Aus dem Fundamentalsatz der Algebra, der von Gauss vollständig bewiesen
wurde, ist bekannt, dass jedes Polynom mit Koeffizienten in $\mathbb{C}$
genau so viele Lösungen in $\mathbb{C}$, wie der Grad des Polynoms angibt.
Dies ist aber ein Existenzsatz, er sagt nichts darüber aus, wie man diese
Lösungen finden kann.
In Spezialfällen, wie zum Beispiel für quadratische Polynome, gibt
es spezialsierte Lösungsverfahren, mit denen man Lösungen angeben kann.
Natürlich existieren numerische Methoden wie zum Beispiel das
Newton-Verfahren, mit dem man Nullstellen von Polynomen beliebig genau
bestimmen kann.

Der Fundamentalsatz der Integralrechnung besagt, dass jede stetige 
Funktion eine Stammfunktion hat, die bis auf eine Konstante eindeutig
bestimmt ist.
Auch dieser Existenzsatz gibt keinerlei Hinweise darauf, wie man die
Stammfunktion finden kann.
In der Analysis-Vorlesung lernt man viele Tricks, die in einer
beindruckenden Zahl von Spezialfällen ermöglichen, ein passende
Funktion anzugeben.
Man lernt auch numerische Verfahren kennen, mit denen sich Werte der
Stammfunktion, also bestimmte Integrale, mit beliebiger Genauigkeit
finden kann.

Die numerische Lösung des Nullstellenproblems ist insofern unbefriedigend,
als sie nur schwer eine Diskussion der Abhängigkeit der Nullstellen von
den Koeffizienten des Polynoms ermöglichen.
Eine Formel wie die Lösungsformel für die quadratische Gleichung 
stellt genau für solche Fälle ein ideales Werkzeug bereit.
Was man sich also wünscht ist nicht nur einfach eine Lösung, sondern eine
einfache Formel zur Bestimmung aller Lösungen.
Im Zusammenhang mit algebraischen Gleichungen erwartet man eine Formel,
in der nur arithmetische Operationen und Wurzeln vorkommen.
Für quadratische Gleichungen ist so eine Formel seit dem Altertum bekannt,
Formeln für die kubische Gleichung und die Gleichung vierten Grades wurden
im 16.~Jahrhundert von Cardano bzw.~Ferrari gefunden.
Erst viel später haben Abel und Ruffini gezeigt, dass so eine allgemeine
Formel für Polynome höheren Grades als 4 nicht existiert.
Die Galois-Theorie, die auf den Ideen von Évariste Galois beruht, 
stellt eine vollständige Theorie unter anderem für die Lösbarkeit
von Gleichungen durch Wurzelausdrücke dar.

Numerische Integralwerte haben ebenfalls den Nachteil, dass damit
Diskussionen wie die Abhängigkeit von Parametern eines Integranden
nur schwer möglich sind.
Was man sich daher wünscht ist eine Formel für die Stammfunktion,
die Werte als Zusammensetzung gut bekannter Funktionen wie der Exponential-
und Logarithmus-Funktionen oder der trigonometrischen Funktionen
sowie Wurzeln, Potenzen und den arithmetischen Operationen.
Man sagt, man möchte die Stammfunktion in ``geschlossener Form'' 
dargestellt haben.
Tatsächlich ist dieses Problem auch zu Beginn des 19.~Jahrhunderts
von Joseph Liouville genauer untersucht worden.
Er hat zunächst eine Klasse von ``elementaren Funktionen'' definiert,
die als Darstellungen einer Stammfunktion in Frage kommen.
Der Satz von Liouville besagt dann, dass nur Funktionen mit einer
ganz speziellen Form eine elementare Stammfunktion haben.
Damit wird es möglich, zu entscheiden, ob ein Integrand wie $e^{-x^2}$ 
eine elementare Stammfunktion hat.
Seit dieser Zeit weiss man zum Beispiel, dass die Fehlerfunktion nicht
mit den bekannten Funktionen dargestellt werden kann.

Mit dem Aufkommen der Computer und vor allem der Computer-Algebra-System (CAS)
wurde die Frage nach der Bestimmung einer Stammfunktion erneut aktuell.
Die ebenfalls weiter entwickelte abstrakte Algebra hat ermöglicht, die
Ideen von Liouville in eine erweiterte, sogenannte differentielle 
Galois-Theorie zu verpacken, die eine vollständige Lösung des Problems
darstellt.
Robert Henry Risch hat in den Sechzigerjahren auf dieser Basis
einen Algorithmus entwickelt, mit dem es möglich wird, zu entscheiden,
ob eine Funktion eine elementare Stammfunktion hat und diese
gegebenenfalls auch zu finden.
Moderne CAS implementieren diesen Algorithmus
in Teilen, besonders weit zu gehen scheint das quelloffene System
Axiom.

Der Risch-Algorithmus hat allerdings eine Achillesferse: er benötigt
eine Method zu entscheiden, ob zwei Ausdrücke übereinstimmen.
Dies ist jedoch ein im Allgemeinen nicht entscheidbares Problem.
Moderne CAS treiben einigen Aufwand, um die
Gleichheit von Ausdrücken zu entscheiden, sie können das Problem
aber grundsätzlich nicht vollständig lösen.
Damit kann der Risch-Algorithmus in praktischen Anwendungen das
Stammfunktionsproblem ebenfalls nur mit Einschränkungen lösen,
die durch die Fähigkeiten des Ausdrucksvergleichs in einem CAS
gesetzt werden.

Im Folgenden sollen elementare Funktionen definiert werden, es sollen
die Grundideen der differentiellen Galois-Theorie zusammengetragen werden
und der Satz von Liouvill vorgestellt werden.
An Hand der Fehler-Funktion soll dann gezeigt werden, wie man jetzt
einsehen kann, dass die Fehlerfunktion nicht elementar darstellbar ist.
Im nächsten Abschnitt dann soll der Risch-Algorithmus skizziert werden.

\subsection{Elementare Funktionen
\label{buch:integrale:section:elementar}}
Es soll die Frage beantwortet werden, welche Stammfunktionen sich
in ``geschlossener Form'' oder durch ``wohlbekannte Funktionen''
ausdrücken lassen.
Welche Funktionen dabei als ``wohlbekannt'' gelten dürfen ist
ziemlich willkürlich.
Sicher möchte man Potenzen und Wurzeln, Logarithmus und Exponentialfunktion,
aber auch die trigonometrischen Funktionen dazu zählen dürfen.
Ausserdem will man beliebig mit den arithmetischen Operationen
rechnen.
So entsteht die Menge der Funktionen, die man ``elementar'' nennen
will.

In der Menge der elementaren Funktionen möchte man jetzt
Stammfunktionen ausgewählter Funktionen suchen.
Dazu muss man von jeder Funktion ihre Ableitung kennen.
Die Ableitungsoperation macht aus der Funktionenmenge eine
differentielle Algebra.
Der Satz von Liouville (Satz~\ref{buch:integrale:satz:liouville1}) 
liefert Bedingungen, die erfüllt sein müssen, wenn eine Funktion
eine elementare Stammfunktion hat.
Sind diese Bedingungen nicht erfüllbar, ist auch keine 
elementare Stammfunktion möglich.

In den folgenden Abschnitten soll die differentielle Algebra
der elementaren Funktionen konstruiert werden.

\subsubsection{Körper}
Die einfachsten Funktionen sind die die Konstanten, für die wir
für die nachfolgenden Betrachtungen fast immer die komplexen Zahlen
$\mathbb{C}$
zu Grunde legen wollen.
Dabei ist vor allem wichtig, dass sich darin alle arithmetischen
Operationen durchführen lassen mit der einzigen Ausnahme, dass
nicht durch $0$ dividiert werden darf.
Man nennt $\mathbb{C}$ daher ein {\em Körper}.
\index{Körper}%
\label{buch:integrale:def:koerper}

\subsubsection{Polynome und rationale Funktionen}
Die Polynome einer Variablen beschreiben eine Menge von
Funktionen, in der Addition, Subtraktion, Multiplikation
von Funktionen und Multiplikation mit komplexen Zahlen
uneingeschränkt möglich ist.
Wir bezeichen wie früher die Menge der Polynome in $z$ mit
$\mathbb{C}[z]$.

Die Division ist erst möglich, wenn man beliebige Brüche
zulässt, deren Zähler und Nenner Polynome sind.
Die Menge
\[
\mathbb{C}(z)
=
\biggl\{
\frac{p(z)}{q(z)}
\;\bigg|\;
p,q\in \mathbb{C}[z]
\biggr\}
\]
heisst die Menge der {\em rationalen Funktionen}.
\label{buch:integrale:def:rationalefunktion}
\index{Funktion, rationale}%
\index{rationale Funktion}%
In ihr sind jetzt alle arithmetischen Operationen ausführbar
ausser natürlich die Division durch die Nullfunktion.
Die rationalen Funktionen bilden also wieder eine Körper.

Die Tatsache, dass die rationalen Funktionen einen Körper
bilden bedeutet auch, dass die Konstruktion erneut durchgeführt
werden kann.
Ausgehend von einem beliebigen Körper $K$ können wieder zunächst
die Polynome $K[X]$ und anschliesen die rationalen Funktionen $K[X]$
in der neuen Variablen, jetzt aber mit Koeffizienten in $K$
gebildet werden.
So entstehen Funktionen von mehreren Variablen und, indem
wir für die neue Variable $X$ zum Beispiel die im übernächsten
Abschnitt betrachtete Wurzel $X=\sqrt{z}$
einsetzen, rationale Funktionen in $z$ und $\sqrt{z}$.

Solche Funktionenkörper werden im folgenden mit geschweiften
Buchstaben $\mathscr{D}$ bezeichnet.
\index{Funktionenkörper}%

\subsubsection{Ableitungsoperation}
In allen Untersuchungen soll immer die Ableitungsoperation
mit berücksichtigt werden.
In unserer Betrachtungsweise spielt es keine Rolle, dass die
Ableitung aus einem Grenzwert entsteht, es sind nur die algebraischen
Eigenschaften wichtig.
Diese sind in der folgenden Definition zusammengefasst.

\begin{definition}
\label{buch:integrale:def:derivation}
Ein {\em Ableitungsoperator} oder eine {\em Derivation} einer Algebra
$\mathscr{D}$ von Funktionen ist eine lineare Abbildung
\[
\frac{d}{dz}
\colon \mathscr{D} \to \mathscr{D}
:
f \mapsto \frac{df}{dz} = f',
\]
die zusätzlich die Produktregel
\begin{equation}
\frac{d}{dz} (fg)
=
\frac{df}{dz} \cdot g + f \cdot \frac{dg}{dz}
\qquad\Leftrightarrow\qquad
(fg)' = f' g + fg'
\label{buch:integrale:eqn:produktregel}
\end{equation}
\index{Produktregel}%
erfüllt.
Die Funktion $f'\in \mathscr{D}$ heisst auch die {\em Ableitung}
von $f\in\mathscr{D}$.
\index{Derivation}%
\index{Ableitungsoperator}%
\index{Ableitung}%
\end{definition}

Die Produktregel hat zum Beispiel auch die bekannten Quotientenregel
zur Folge.
Dazu betrachten wir das Produkt $f= (f/g)\cdot g$ und leiten es mit
Hilfe der Produktregel ab:
\[
\frac{d}{dz}f
=
\frac{d}{dz}
\biggl(
\frac{f}{g}\cdot g
\biggr)
=
{\color{darkred}
\frac{d}{dz}
\biggl(
\frac{f}{g}
\biggr)}
\cdot g
+
\frac{f}{g}\cdot \frac{d}{dz}g.
\]
Jetzt lösen wir nach der {\color{darkred}roten} Ableitung des Quotienten
auf und erhalten
\begin{equation}
\biggl(\frac{f}{g}\biggr)'
=
\frac{d}{dz}\biggl(\frac{f}{g}\biggr)
=
\frac1g\biggl(
\frac{d}{dz}f - \frac{f}{g}\cdot \frac{d}{dz}g
\biggr)
=
\frac{1}{g}
\biggl(
f'-\frac{fg'}{g}
\biggr)
=
\frac{f'g-fg'}{g^2}.
\label{buch:integrale:eqn:quotientenregel}
\end{equation}
Dies ist die Quotientenregel.

Aus der Produktregel folgt natürlich sofort auch die Potenzregel
für die Ableitung der $n$ten Potenz einer Funktion $f\in\mathscr{D}$, 
sie lautet:
\begin{equation}
\frac{d}{dz} f^n
= 
\underbrace{
f'f^{n-1} + ff'f^{n-2} + f^2f'f^{n-3}+\dots f^{n-1}f'
}_{\displaystyle \text{$n$ Terme}}
=
nf^{n-1}f'.
\label{buch:integrale:eqn:potenzregel}
\end{equation}
In dieser Form versteckt sich natürlich auch die Kettenregel, die
Potenzfunktion ist die äussere Funktion, $f$ die innere, $f'$ ist also
die Ableitung er inneren Funktion, wie in der Kettenregel verlangt.
Falls $f$ ein Element von $\mathscr{D}$ ist mit der Eigenschaft
$df/dz=1$, dann entsteht die übliche Produktregel.

\begin{definition}
Eine Algebra $\mathscr{D}$ von Funktionen mit einem Ableitungsoperator 
$d/dz$ heisst eine {\em differentielle Algebra}.
\index{differentielle Algebra}%
\index{Algebra, differentielle}%
In einer differentiellen Algebra gelten die üblichen
Ableitungsregeln.
\end{definition}

Die Potenzregel war in der Form~\eqref{buch:integrale:eqn:potenzregel}
geschrieben worden, nicht als die Ableitung von $z$.
Der Grund dafür ist, dass wir gar nicht voraussetzen wollen, dass in
unserer differentiellen Algebra eine Funktion existiert, die die
Rolle von $z$ hat.
Dies ist gar nicht nötig, wie das folgende Beispiel zeigt.

\begin{beispiel}
Als Funktionenmenge $\mathscr{D}$ nehmen wir rationale Funktionen
in zwei Variablen, die wir $\cos x $ und $\sin x$ nennen.
Diese Menge bezeichnen wir mit
$\mathscr{D}=\mathbb{Q}(\cos x,\sin x)$
Der Ableitungsoperator ist 
\begin{align*}
\frac{d}{dx} \cos x &= -\sin x
\\
\frac{d}{dx} \sin x &= \phantom{-}\cos x.
\end{align*}
Die Funktionen von $\mathbb{Q}(\cos x,\sin x)$ sind also Brüche,
deren Zähler und Nenner Polynome in $\cos x$ und $\sin x$ sind.
Aus den Produkt- und Quotientenregeln und den Ableitungsregeln für
$\cos x$ und $\sin x$ folgt, dass die Ableitung einer Funktion in
$\mathscr{D}$ wieder in $\mathscr{D}$ ist, $\mathscr{D}$ ist eine
differentielle Algebra.
\end{beispiel}

Die konstanten Funktionen spielen eine besondere Rolle.
Da wir bei der Ableitung nicht von der Vorstellung einer
Funktion mit einem variablen Argument ausgehen wollten und 
die Ableitung nicht als Grenzwert definieren wollten, müssen
wir auch bei der Definition der ``Konstanten'' einen neuen
Weg gehen.
In der Analysis sind die Konstanten genau die Funktionen,
deren Ableitung $0$ ist.

\begin{definition}
\label{buch:integrale:def:konstante}
Ein Element $f\in \mathscr{D}$ mit $df/dz=f'=0$ heissen
{\em Konstante} in $\mathscr{D}$.
\index{Konstante}%
\end{definition}

Die in der Potenzregel~\eqref{buch:integrale:eqn:potenzregel}
vermisste Funktion $z$ kann man ähnlich zu den Konstanten
zu definieren versuchen.
$z$ müsste ein Element von $\mathscr{D}$ mit $z' = 1$ sein.
Allerdings gibt es viele solche Elemente, ist $c$ eine Konstanten
und $z'=1$, dann ist auch $(z+c)'=1$, $(z+c)$ hat also für
die Zwecke unserer Untersuchung die gleichen Eigenschaften wie
$z$.
Dies deckt sich natürlich auch mit der Erwartung, dass Stammfunktionen
nur bis auf eine Konstante bestimmt sind.
Eine differentielle Algebra muss allerdings kein Element $z$ mit der
Eigenschaft $z'=1$ enthalten.

\begin{beispiel}
In $\mathscr{D}=\mathbb{Q}(\cos x,\sin x)$ gibt es kein Element $x$.
Ein solches wäre von der Form
\[
x = \frac{p(\cos x,\sin x)}{q(\cos x,\sin x)}.
\]
Eine solche goniometrische Beziehung würde für $x=\frac{\pi}4$ bedeuten,
dass
\[
\frac{\pi}4
=
\frac{p(\sqrt{2}/2,\sqrt{2}/2)}{q(\sqrt{2}/2,\sqrt{2}/2)}.
\]
Auf der rechten Seite steht ein Quotient von Polynome, in dessen
Argument nur rationale Zahlen und $\sqrt{2}$ steht.
So ein Ausdruck kann immer in die Form
\[
\pi
=
4\frac{a\sqrt{2}+b}{c\sqrt{2}+d}
=
\frac{4(a\sqrt{2}+b)(c\sqrt{2}-d)}{2c^2+d^2}
=
r\sqrt{2}+s
\]
gebracht werden.
Die Zahl auf der rechten Seite ist zwar irrational, aber sie ist Nullstelle
des quadratischen Polynoms
\[
p(x)
=
(x-r\sqrt{2}-s)(x+r\sqrt{2}-s)
=
x^2
-2sx
-2r^2+s^2
\]
mit rationalen Koeffizienten, wie man mit der Lösungsformel für die
quadratische Gleichung nachprüfen kann.
Es ist bekannt, dass $\pi$ als transzendente Zahl nicht Nullstelle
eines Polynoms mit rationalen Koeffizienten ist.
Dieser Widerspruch zeigt, dass $x$ nicht in $\mathbb{Q}(\cos x, \sin x)$
vorkommen kann.
\end{beispiel}

In einer differentiellen Algebra kann jetzt die Frage nach der
Existenz einer Stammfunktion gestellt werden.

\begin{aufgabe}
Gegeben eine differentielle Algebra $\mathscr{D}$ und ein Element
$f\in\mathscr{D}$, entscheide, ob es ein Element $F\in\mathscr{D}$ 
gibt mit der Eigenschaft $F'=f$.
Ein solches $F\in\mathscr{D}$ heisst {\em Stammfunktion} von $f$.
\end{aufgabe}

\begin{satz}
In einer differentiellen Algebra $\mathscr{D}$ mit $z\in\mathscr{D}$
hat die Potenzfunktion $f=z^n$ für $n\in\mathbb{N}\setminus\{-1\}$
ein Stammfunktion, nämlich 
\[
F = \frac{1}{n+1} z^{n+1}.
\]
\label{buch:integrale:satz:potenzstammfunktion}
\end{satz}

\begin{proof}[Beweis]
Tatsächlich kann man dies sofort nachrechnen, muss allerdings die
Fälle $n+1 >0$ und $n+1<0$ unterscheiden, da die Potenzregel
\eqref{buch:integrale:eqn:potenzregel} nur für natürliche Exponenten
gilt.
Man erhält
\begin{align*}
n+1&>0\colon
&
\frac{d}{dz}\frac{1}{n+1}z^{n+1}
&=
\frac{1}{n+1}(n+1)z^{n+1-1}
=
z^n,
\\
n+1&<0\colon
&
\frac{d}{dz}\frac{1}{n+1}\frac{1}{z^{-(n+1)}}
&=
\frac{1}{n+1}\frac{1'z^{-(n+1)}-1(-(n+1))z^{-n-1-1}}{z^{-2n-2}}
\\
&&
&=
\frac{1}{n+1}
\frac{(n+1)z^n{-n-2}}{z^{-2n-2}}
\\
&&
&=
\frac{1}{z^{-n}}=z^n.
\end{align*}
Man beachte, dass in dieser Rechnung nichts anderes als die
algebraischen Eigenschaften der Produkt- und Quotientenregel
verwendet wurden.
\end{proof}

\subsubsection{Wurzeln}
Die Wurzelfunktionen sollen natürlich als elementare Funktionen
erlaubt sein.
Es ist bekannt, dass $\sqrt{z}\not\in \mathscr{D}=\mathbb{C}(z)$
ist, ein solches Element müsste also erst noch hinzugefügt werden.
Dabei muss auch seine Ableitung definiert werden.
Auch dabei dürfen wir nicht auf eine Grenzwertüberlegung zurückgreifen,
vielmehr müssen wir die Ableitung auf vollständig algebraische
Weise bestimmen.

Wir schreiben $f=\sqrt{z}$ und leiten die Gleichung $f^2=z$ nach $z$ ab.
Dabei ergibt sich nach der Potenzregel
\[
\frac{d}{dz}f^2 = 2f'f = \frac{d}{dz}z=1
\qquad\Rightarrow\qquad f' = \frac{1}{2f}.
\]
Diese Rechnung lässt sich auch auf $n$-Wurzeln $g=\root{n}\of{z}$ mit
der Gleichung $g^n = z$ verallgemeinern.
Die Ableitung der $n$-ten Wurzel ist
\begin{equation}
\frac{d}{dz}g^n
=
ng^{n-1} = \frac{d}{dz}z=1
\qquad\Rightarrow\qquad
\frac{d}{dz}g = \frac{1}{ng^{n-1}}.
\end{equation}
Es ist also möglich, eine differentielle Algebra $\mathscr{D}$ mit einer
$n$-ten Wurzel $g$ zu einer grösseren differentiellen Algebra $\mathscr{D}(g)$
zu erweitern, in der wieder alle Regeln für das Rechnen mit Ableitungen
erfüllt sind.

\subsubsection{Algebraische Elemente}
% Begriff der algebraischen Funktion
% Konjugation, Spur und Norm

\subsubsection{Logarithmen und Exponentialfunktionen}
Die Funktion $z^{-1}$ musste im
Satz~\ref{buch:integrale:satz:potenzstammfunktion}
ausgeschlossen werden, sie hat keine Stammfunktion in $\mathbb{C}(z)$.
Aus der Analysis ist bekannt, dass die Logarithmusfunktion $\log z$ 
eine Stammfunktion ist.
Der Logarithmus von $z$ aber auch der Logarithmus $\log f(z)$
einer beliebigen Funktion $f(z)$ oder die Exponentialfunktion $e^{f(z)}$
sollen ebenfalls elementare Funktionen sein.
Da wir aber auch hier nicht auf die analytischen Eigenschaften zurückgreifen
wollen, brauchen wir ein rein algebraische Definition.

\begin{definition}
\label{buch:integrale:def:logexp}
Sei $\mathscr{D}$ ein differentielle Algebra und $f\in\mathscr{D}$.
Ein Element $\vartheta\in\mathscr{D}$ heisst ein {\em Logarithmus}
von $f$, geschrieben $\vartheta = \log f$, wenn $f\vartheta' = f'$ gilt.
$\vartheta$ heisst eine Exponentialfunktion von $f$ wenn
$\vartheta'=\vartheta f'$ gilt.
\end{definition}

Die Formel für die Exponentialfunktion ist etwas vertrauter, sie ist
die bekannte Kettenregel
\begin{equation}
\vartheta'
=
\frac{d}{dz} e^f
=
e^f \cdot \frac{d}{dz} f
=
\vartheta \cdot f'.
\label{buch:integrale:eqn:exponentialableitung}
\end{equation}
Da wir uns vorstellen, dass Logarithmen Umkehrfunktionen von 
Exponentialfunktionen sein sollen, 
muss die definierende Gleichung genau wie
\eqref{buch:integrale:eqn:exponentialableitung}
aussehen, allerdings mit vertauschten Plätzen von $f$ und $\vartheta$,
also 
\begin{equation}
\vartheta' = \vartheta\cdot f'
\qquad
\rightarrow
\qquad
f' = f\cdot \vartheta'
\;\Leftrightarrow\;
\vartheta' = (\log f)' = \frac{f'}{f}.
\label{buch:integrale:eqn:logarithmischeableitung}
\end{equation}
Dies ist die aus der Analysis bekannte Formel für die logarithmische
Ableitung.

Der Logarithmus von $f$ und die Exponentialfunktion von $f$ sollen
also ebenfalls als elementare Funktionen betrachtet werden.

\subsubsection{Die trigonometrischen Funktionen}
Die bekannten trigonometrischen Funktionen und ihre Umkehrfunktionen
sollten natürlich auch elementare Funktionen sein.
Dabei kommt uns zur Hilfe, dass sie sich mit Hilfe der Exponentialfunktion
als
\[
\cos f = \frac{e^{if}+e^{-if}}2
\qquad\text{und}\qquad
\sin f = \frac{e^{if}-e^{-if}}{2i}
\]
schreiben lassen.
Eine differentielle Algebra, die die Exponentialfunktionen von $if$ und
$-if$ enthält, enthält also automatisch auch die trigonometrischen
Funktionen.
Im Folgenden ist es daher nicht mehr nötig, die trigonometrischen
Funktionen speziell zu untersuchen.

\subsection{Erweiterungen einer differentiellen Algebra
\label{buch:integrale:section:erweiterungen}}


\subsubsection{Logarithmen und Exponentiale}

\subsubsection{Elementare Körpererweiterungen}

\subsection{Der Satz von Liouville
\label{buch:integrale:section:liouville}}

\subsection{Die Fehlerfunktion ist keine elementare Funktion
\label{buch:integrale:section:fehlernichtelementar}}
% \url{https://youtu.be/bIdPQTVF5n4}
Mit Hilfe des Satzes von Liouville kann man jetzt beweisen, dass 
die Fehlerfunktion keine elementare Funktion ist.
Dazu braucht man die folgende spezielle Form des Satzes.

\begin{satz}
\label{buch:integrale:satz:elementarestammfunktion}
Wenn $f(x)$ und $g(x)$ rationale Funktionen von $x$ sind, dann
ist die Stammfunktion von $f(x)e^{g(x)}$ genau dann eine 
elementare Funktion, wenn es eine rationale Funktion gibt, die
Lösung der Differentialgleichung
\[
r'(x) + g'(x)r(x)=f(x)
\]
ist.
\end{satz}

\begin{satz}
Die Funktion $x\mapsto e^{-x^2}$ hat keine elementare Stammfunktion.
\label{buch:iintegrale:satz:expx2}
\end{satz}

\begin{proof}[Beweis]
Unter Anwendung des Satzes~\ref{buch:integrale:satz:elementarestammfunktion}
auf $f(x)=1$ und $g(x)=-x^2$ folgt, $e^{-x^2}$ genau dann eine rationale 
Stammfunktion hat, wenn es eine rationale Funktion $r(x)$ gibt, die
Lösung der Differentialgleichung
\begin{equation}
r'(x) -2xr(x)=1
\label{buch:integrale:expx2dgl}
\end{equation}
ist.

Zunächst halten wir fest, dass $r(x)$ kein Polynom sein kann.
Wäre nämlich 
\[
r(x)
=
a_0 + a_1x + \dots + a_nx^n
=
\sum_{k=0}^n a_kx^k
\quad\Rightarrow\quad
r'(x)
=
a_1 + 2a_2x + \dots + na_nx^{n-1}
=
\sum_{k=1}^n
ka_kx^{k-1}
\]
ein Polynom, dann ergäbe sich beim Einsetzen in die Differentialgleichung
\begin{align*}
1
&=
r'(x)-2xr(x)
\\
&=
a_1 + 2a_2x + 3a_3x^2 + \dots + (n-1)a_{n-1}x^{n-2} + na_nx^{n-1}
\\
&\qquad
-
2a_0x -2a_1x^2 -2a_2x^3 - \dots - 2a_{n-1}x^n - 2a_nx^{n+1}
\\
&
\hspace{0.7pt}
\renewcommand{\arraycolsep}{1.8pt}
\begin{array}{crcrcrcrcrcrcrcr}
=&a_1&+&2a_2x&+&3a_3x^2&+&\dots&+&(n-1)a_{n-1}x^{n-2}&+&na_{n  }x^{n-1}& &           & & \\
 &   &-&2a_0x&-&2a_1x^2&-&\dots&-&    2a_{n-3}x^{n-2}&-&2a_{n-2}x^{n-1}&-&2a_{n-1}x^n&-&2a_nx^{n+1}
\end{array}
\\
&=
a_1
+
(2a_2-2a_0)x
+
(3a_3-2a_1)x^2
%+
%(4a_4-2a_2)x^3
+
\dots
+
(na_n-2a_{n-2})x^{n-1}
-
2a_{n-1}x^n
-
2a_nx^{n+1}.
\end{align*}
Koeffizientenvergleich zeigt, dass $a_1=1$ sein muss.
Aus den letzten zwei Termen liest man ebenfalls mittels Koeffizientenvergleich
ab, dass $a_n=0$ und $a_{n-1}=0$ sein müssen.
Aus den Koeffizienten $(ka_k-2a_{k-2})=0$ folgt, dass
$a_{k-2}=\frac{k}{2}a_k$ für alle $k>1$ sein muss, diese Koeffizienten
verschwinden also auch, inklusive $a_1=0$.
Dies ist allerdings im Widerspruch zu $a_1=1$.
Es folgt, dass $r(x)$ kein Polynom sein kann.

Der Nenner der rationalen Funktion $r(x)$ hat also mindestens eine Nullstelle
$\alpha$, man kann daher $r(x)$ auch schreiben als
\[
r(x) = \frac{s(x)}{(x-\alpha)^n},
\]
wobei die rationale Funktion $s(x)$ keine Nullstellen und keine Pole hat.
Einsetzen in die Differentialgleichung ergibt:
\[
1
=
r'(x) -2xr(x)
=
\frac{s'(x)}{(x-\alpha)^n}
-n
\frac{s(x)}{(x-\alpha)^{n+1}}
-
\frac{2xs(x)}{(x-\alpha)^n}.
\]
Multiplizieren mit $(x-\alpha)^{n+1}$ gibt
\[
(x-\alpha)^{n+1}
=
s'(x)(x-\alpha)
-
ns(x)
-
2xs(x)(x-\alpha)
\]
Setzt man $x=\alpha$ ein, verschwinden alle Terme ausser dem mittleren
auf der rechten Seite, es bleibt
\[
ns(\alpha) = 0.
\]
Dies widerspricht aber der Wahl der rationalen Funktion $s(x)$, für die
$\alpha$ keine Nullstelle ist.

Somit kann es keine rationale Funktion $r(x)$ geben, die eine Lösung der
Differentialgleichung~\eqref{buch:integrale:expx2dgl} ist und
die Funktion $e^{-x^2}$ hat keine elementare Stammfunktion.
\end{proof}

Der Satz~\ref{buch:iintegrale:satz:expx2} rechtfertigt die Einführung 
der Fehlerfunktion $\operatorname{erf}(x)$ als neue spezielle Funktion,
mit deren Hilfe die Funktion $e^{-x^2}$ integriert werden kann.



