%
% sqrat.tex
%
% (c) 2022 Prof Dr Andreas Müller, OST Ostschweizer Fachhochschlue
%
\subsection{Integranden der Form $R(x,\sqrt{ax^2+bx+c})$
\label{buch:integral:subsection:rxy}}
Für rationale Funktionen lässt sich immer eine Stammfunktion in einem
Erweiterungskörper angeben, der durch Hinzufügen einzelner logarithmischer
Funktionen entsteht.
Die dabei verwendeten Techniken lassen sich verallgemeinern.
Zur Illustration und Motivation des später beschriebenen Risch-Algorithmus
stellen wir uns in diesem Abschnitt der Aufgabe, Integrale
mit einem Integranden zu berechnen, der eine rationale Funktion von $x$
und $\sqrt{ax^2+bx+c}$ ist.

%
% Aufgabenstellung
%
\subsubsection{Aufgabenstellung}
Eine rationale Funktion von $x$ und $\sqrt{ax^2+bx+c}$ ist ein
Element des Differentialkörpers, den man aus $\mathbb{Q}(x)$ durch
hinzufügen des Elementes
\[
y=\sqrt{ax^2+bx+c}
\]
erhält.
Eine Funktion $f\in\mathbb{Q}(x,y)$ kann geschrieben werden als Bruch
\begin{equation}
f
=
\frac{
\tilde{p}_0 + \tilde{p}_1y + \dots + \tilde{p}_n y^n
}{
\tilde{q}_0 + \tilde{q}_1y + \dots + \tilde{q}_m y^m
}
\label{buch:integral:sqrat:eqn:ftilde}
\end{equation}
mit rationalen Koeffizienten $\tilde{p}_i,\tilde{q}_i\in\mathbb{Q}(x)$.
Gesucht ist eine Stammfunktion von $f$.

%
% Algebraische Vereinfachungen
%
\subsubsection{Algebraische Vereinfachungen}
Da $y^2=ax^2+bx+c$ ein Polynom ist, sind auch alle geraden Potenzen
von $y$ Polynome in $\mathbb{Q}(x)$,
und die ungeraden Potenzen von $y$ lassen sich als Produkt aus einem
Polynom und dem Faktor $y$ schreiben.
Der Integrand~\eqref{buch:integral:sqrat:eqn:ftilde} 
lässt sich daher vereinfachen zu einem Bruch der Form
\begin{equation}
f(x)
=
\frac{p_0+p_1y}{q_0+q_1y},
\label{buch:integral:sqrat:eqn:moebius}
\end{equation}
wobei $p_i$ und $q_i$ rationale Funktionen in $\mathbb{Q}(x)$ sind.

%
% Rationalisieren
%
\subsubsection{Rationalisieren}
Unschön an der Form~\eqref{buch:integral:sqrat:eqn:moebius} ist die
Tatsache, dass $y$ sowohl im Nenner wie auch im Zähler auftreten kann.
Da aber $y$ die quadratische Identität $y^2=ax^2+bx+c$ erfüllt,
kann das $y$ im Nenner durch Erweitern mit $q_0-q_1y$ zum verschwinden
gebracht werden.
Die Rechnung ergibt
\begin{align*}
\frac{p_0+p_1y}{q_0+q_1y}
&=
\frac{p_0+p_1y}{q_0+q_1y}
\cdot
\frac{q_0-q_1y}{q_0-q_1y}
=
\frac{(p_0+p_1y)(q_0-q_1y)}{q_0^2-q_1^2y^2}
\\
&=
\frac{p_0q_0-p_1q_1(ax^2+bx+c)}{q_0^2-q_1^2(ax^2+bx+c)}
+
\frac{q_0p_1-q_1p_0}{q_0^2-q_1^2(ax^2+bx+c)} y.
\end{align*}
Die Quotienten enthalten $y$ nicht mehr, sind also in $\mathbb{Q}(x)$.
In der späteren Rechnung wird sich herausstellen, dass es praktischer ist,
das $y$ im Nenner zu haben, was man durch erweitern mit $y$ wieder
unter Ausnützung von $y^2=ax^2+bx+c$ erreichen kann.
Die zu integrierende Funktion  kann also in der Form
\begin{equation}
f(x)
=
W_1 + W_2\frac{1}{y}
\label{buch:integral:sqint:eqn:w1w2y}
\end{equation}
geschrieben werden mit rationalen Funktionen
$W_1,W_2\in\mathbb{Q}(x)$.
Eine Stammfunktion von $W_1$ kann mit der Methode von
Abschnitt~\ref{buch:integral:subsection:rationalefunktionen}
gefunden werden.
Im Folgenden kümmern wir uns daher nur noch um $W_2/y$.

%
% Polynomdivision
%
\subsubsection{Polynomdivision}
Die Funktion $W_2$ in \eqref{buch:integral:sqint:eqn:w1w2y} ist eine
rationale Funktion $W_2\in \mathbb{K}(x)$, also ein Bruch mit Polynomen
in $x$ als Zähler und Nenner.
Durch Polynomdivision mit Rest können wir $W_2$ schreiben als
\[
W_1 = \varphi + W_3,
\]
wobei $\varphi$ ein Polynom in $x$ ist und $W_3$ eine rationale
Funktion, deren Zählergrad kleiner ist als der Nennergrad.
Zur Bestimmung der Stammfunktion bleibt jetzt nur noch
\begin{equation}
\int W_2\frac{1}{y}
=
\int \frac{\varphi}{y} 
+
\int W_3\frac1{y}
\label{buch:integral:sqint:eqn:Wy}
\end{equation}
zu berechnen.

%
% Integranden der Form $\varphi(x)/y$
%
\subsubsection{Integranden der Form $\varphi(x)/y$}
Der erste Term in~\eqref{buch:integral:sqint:eqn:Wy} ist ein Integral eines
Quotienten eines Polynoms geteilt durch $y$.
Solche Integrale können, wie im Folgenden gezeigt werden soll, reduziert
werden auf das Integral von $1/y$.
Genauer gilt der folgende Satz.

\begin{satz}
\label{buch:integral:sqint:satz:polyy}
Sei $\varphi\in\mathscr{K}(x)$ ein Polynom in $x$, dann gibt
es ein Polynom $\psi\in\mathscr{K}(x)$ vom Grad $\deg\psi < \deg\varphi$,
und $A\in\mathscr{K}$ derart, dass
\begin{equation}
\int \frac{\varphi}{y}
=
\psi y + A\int\frac{1}{y}.
\label{buch:integral:sqint:eqn:phipsi}
\end{equation}
\end{satz}

\begin{proof}[Beweis]
Wir schreiben die Polynome in der Form
\begin{align*}
\varphi
&=
\varphi_mx^m + \varphi_{m-1}x^{m-1} + \dots + \varphi_2x^2 + \varphi_1x + \varphi_0
\\
\psi
&=
\phantom{\varphi_mx^m+\mathstrut}
\psi_{m-1}x^{m-1} + \dots + \psi_2x^2 + \psi_1x + \psi_0
\intertext{mit der Ableitung}
\psi'
&=
\phantom{\varphi_mx^m+\mathstrut}
\psi_{m-1}(m-1)x^{m-2} + \dots + 2\psi_2x + \psi_1.
\end{align*}
Wir leiten  die Gleichung~\eqref{buch:integral:sqint:eqn:phipsi}
nach $x$ ab und erhalten
\begin{align*}
\frac{\varphi}{y}
&=
\psi'y + \psi y' + \frac{A}{y}
=
\psi'y + \psi \frac{ax+b/2}{y} + \frac{A}{y}.
\intertext{Durch Multiplikation mit $y$ wird die Gleichung wesentlich
vereinfacht zu}
\varphi
&=
\psi' y^2 + \psi y' y + A
=
\psi' \cdot(ax^2+bx+c) + \psi\cdot (ax+b/2) + A.
\end{align*}
Auf beiden Seiten stehen Polynome, man kann daher versuchen, die
Koeffizienten von $\psi$ mit Hilfe eines Koeffizientenvergleichs zu
bestimmen.
Dazu müssen die Produkte auf der rechten Seite ausmultipliziert werden.
So ergeben sich die Gleichungen
\begin{equation}
\renewcommand{\arraycolsep}{2pt}
\begin{array}{lcrcrcrcrcrcrcr}
\varphi_m
&=&
(m-1)\psi_{m-1} a &+&     & & 
&+&
\psi_{m-1} a & &      & &
\\
\varphi_{m-1}
&=&
(m-2)\psi_{m-2}a
&+&
(m-1)\psi_{m-1}b
& &
&+&
\psi_{m-2}a
&+&
\psi_{m-1}\frac{b}2
& &
\\
\varphi_{m-2}
&=&
(m-3)\psi_{m-3}a
&+&
(m-2)\psi_{m-2}b
&+&
(m-1)\psi_{m-1}c
&+&
\psi_{m-3}a
&+&
\psi_{m-2}\frac{b}2
& &
\\
&\vdots&&&&&&&&&&&
\\
\varphi_2
&=&
\psi_{1\phantom{-m}}a
&+&
2\psi_{2\phantom{-m}}b
&+&
3\psi_{3\phantom{-m}}c
&+&
\psi_{1\phantom{-m}}a
&+&
\psi_{2\phantom{-m}}\frac{b}2
& &
\\
\varphi_1
&=&
& &
\psi_{1\phantom{-m}}b
& &
2\psi_{2\phantom{-m}}c
&+&
\psi_{0\phantom{-m}}a
&+&
\psi_{1\phantom{-m}}\frac{b}2
\\
\varphi_0
&=&
& &
& &
\psi_{1\phantom{-m}}c
& &
&+&
\psi_{0\phantom{-m}}\frac{b}2
&+&A.
\end{array}
\end{equation}
In jeder Gleichung kommen höchstens drei der Koeffizienten von $\psi$ vor.
Fasst man sie zusammen und stellt die Terme etwas um,
erhält man die einfacheren Gleichungen
\begin{equation}
\renewcommand{\arraycolsep}{2pt}
\renewcommand{\arraystretch}{1.3}
\begin{array}{lcrcrcrcrcrcrcr}
\varphi_m
&=&
(m-0){\color{red}\psi_{m-1}}a & &     & & 
& &
\\
\varphi_{m-1}
&=&
(m-1+\frac12)\psi_{m-1}b
&+&
(m-1){\color{red}\psi_{m-2}}a
& &
& &
\\
\varphi_{m-2}
&=&
(m-1)\psi_{m-1}c
&+&
(m-2+\frac12)\psi_{m-2}b
&+&
(m-2){\color{red}\psi_{m-3}}a
& &
\\
&\vdots&&&&&&&&&&&
\\
\varphi_2
&=&
3\psi_{3\phantom{-m}}c
&+&
(2+\frac12)\psi_{2\phantom{-m}}b
&+&
2{\color{red}\psi_{1\phantom{-m}}}a
& &
\\
\varphi_1
&=&
2\psi_{2\phantom{-m}}c
&+&
(1+\frac12)\psi_{1\phantom{-m}}b
&+&
{\color{red}\psi_{0\phantom{-m}}}a
& &
\\
\varphi_0
&=&
\psi_{1\phantom{-m}}c
& &
&+&
(0+\frac12) \psi_{0\phantom{-m}}b
&+&{\color{red}A}
\end{array}
\end{equation}
Die erste Gleichung kann wegen $a\ne 0$ nach $\psi_{m-1}$ aufgelöst werden,
dadurch ist $\psi_{m-1}$ bestimmt.
In allen folgenden Gleichungen taucht jeweils ein neuer Koeffizient
von $\psi$ auf, der rot hervorgehoben ist.
Wieder wegen $a\ne 0$ kann die Gleichung immer nach dieser Variablen
aufgelöst werden.
Die Gleichungen zeigen daher, dass die Koeffizienten des Polynoms $\psi$
in absteigender Folge und die Konstante $A$ eindeutig bestimmt werden.
\end{proof}

Mit diesem Satz ist das Integral über den Teil $\varphi/y$ auf den
Fall des Integrals von $1/y$ reduziert.
Letzteres wird im nächsten Abschnitt berechnet.

%
% Das Integral von $1/y$
%
\subsubsection{Das Integral von $1/y$}
Eine Stammfunktion von $1/y$ kann mit etwas Geschick mit den 
Interationstechniken gefunden werden, die man in einem Analysis-Kurs
lernt.
Durch Ableitung der Funktion
\[
F
=
\frac{1}{\sqrt{a}}\log\biggl(x+\frac{b}{2a}+\frac{y}{\sqrt{a}}\biggr)
\]
kann man nachprüfen, dass $F$ eine Stammfunktion von $1/y$ ist,
also
\begin{equation}
\int
\frac{1}{y}
=
\frac{1}{\sqrt{a}}\log\biggl(x+\frac{b}{2a}+\frac{y}{\sqrt{a}}\biggr).
\end{equation}

%
% Partialbruchzerlegung
%
\subsubsection{Partialbruchzerlegung}
In der rationalen Funktion $W_3$ in \eqref{buch:integral:sqint:eqn:Wy}
hat der Zähler kleineren Grad als der Nenner, sie kann daher wieder
in Partialbrüche
\[
W_3
=
\sum_{i=1}^n
\sum_{k=1}^{k_i}
\frac{A_{ik}}{(x-\alpha_i)^k}
\]
mit den Nullstellen $\alpha_i$ des Nenners von $W_3$ mit Vielfachheiten
$k_i$ zerlegt werden.
Die Stammfunktion von $W_3/y$ wird damit zu
\begin{equation}
\int W_3\frac{1}{y}
=
\sum_{i=1}^n
\sum_{k=1}^{k_i}
A_{ik}
\int
\frac{1}{(x-\alpha_i)^ky}
=
\sum_{i=1}^n
\sum_{k=1}^{k_i}
A_{ik}
\int
\frac{1}{(x-\alpha_i)^k \sqrt{ax^2+bx+c}}.
\end{equation}
Die Stammfunktion ist damit reduziert auf Integrale der Form
\begin{equation}
\int
\frac{1}{(x-\alpha)^k \sqrt{ax^2+bx+c}}
\label{buch:integral:sqrat:eqn:2teart}
\end{equation}
mit $k>0$.

%
% Integrale der Form \eqref{buch:integral:sqrat:eqn:2teart}
%
\subsubsection{Integrale der Form \eqref{buch:integral:sqrat:eqn:2teart}}
Die Integrale~\eqref{buch:integral:sqrat:eqn:2teart} 
können mit Hilfe der Substution 
\[
t=\frac{1}{x-\alpha}
\qquad\text{oder}\qquad
x=\frac1t+\alpha
\]
In ein Integral verwandelt werden, für welches bereits eine 
Berechnungsmethode entwickelt wurde.
Dazu berechnet man
\begin{align*}
y^2
&= a\biggl(\frac1t+\alpha\biggr)^2 + b\biggl(\frac1t+\alpha\biggr) + c
\\
&=
a\biggl(\frac{1}{t^2}+2\frac{\alpha}{t}+\alpha^2\biggr)
+\frac{b}{t}+b\alpha+c
=
\frac{1}{t^2}\bigl(
\underbrace{a+(2a\alpha+b)t+(a\alpha^2+c)t^2}_{\displaystyle=Y^2}
\bigr)
\intertext{und damit}
y&=\frac{Y}{t}.
\end{align*}
Führt man die Substition
$dx = -dt/t^2$ im Integral aus, erhält man
\begin{align*}
\int\frac{dx}{(x-\alpha)^ky}
&=
-
\int
t^k\cdot\frac{t}{Y}\frac{dt}{t^2}
=
-\int\frac{t^{k-1}}{Y}\,dt.
\end{align*}
Das letzte Integral ist wieder von der Form, die in
Satz~\ref{buch:integral:sqint:satz:polyy} behandelt wurde.
Insbesondere gibt es ein Polynom $\psi$ vom Grad $k-2$ und
eine Konstante $A$ derart, dass
\[
\int\frac{1}{(x-\alpha)^ky}
=
\psi Y + A\int\frac{1}{Y}
\]
ist.
Damit ist das Integral von $R(x,y)$ vollständig bestimmt.

%
% Beobachtungen
%
\subsubsection{Beobachtungen}
Die eben dargestellte Berechnung des Integrals von $R(x,y)$ zeigt einige
Gemeinsamkeiten mit der entsprechenden Rechnung für rationale
Integranden, aber auch einige wesentliche Unterschiede.
Wieder zeigt sich, dass Polynomdivision und Partialbruchzerlegung
die zentralen Werkzeuge sind, mit denen der Integrand zerlegt und
leichter integrierbare Funktionen umgeformt werden kann.
Andererseits ist der in 
Satz~\ref{buch:integral:sqint:satz:polyy}
zusammengefasste Schritt eine wesentliche zusätzliche Vereinfachung,
die keine Entsprechung bei rationalen Integranden hat.

Die gefunde Stammfunktion hat die allgemeine Form
\begin{equation}
\int R(x,y)
=
v_0 +
C
\log\biggl(x+\frac{b}{2a}+\frac{y}{\sqrt{a}}\biggr)
+
\sum_{i=1}^n c_i
\log v_i,
\label{buch:inetgral:sqrat:eqn:liouville}
\end{equation}
die ganz der bei rationalen Integranden gefunden Form entspricht.
Darin ist $v_0$ die Summe der angefallenen rationalen Teilintegrale,
also $v_0\in\mathscr{K}(x,y)$.
Die $v_i\in\mathscr{K}(x,y)$ sind die entsprechenden Logarithmusfunktionen,
die bei der Berechnung der Integrale \eqref{buch:integral:sqrat:eqn:2teart}
auftreten.
Insbesondere liefert die Rechnung eine Körpererweiterung von
$\mathscr{K}(x,y)$ um die logarithmische Funktionen
$\log(x+b/2a+y/\!\sqrt{y})$ und $\log v_i$, in der $R(x,y)$ eine
Stammfunktion hat.




