%
% hypergeometrisch.tex
%
% (c) 2021 Prof Dr Andreas Müller, OST Ostschweizer Fachhochschule
%
\section{Hypergeometrische Differentialgleichung
\label{buch:differentialgleichungen:section:hypergeometrisch}}
Die hypergeometrische Funktion $\mathstrut_2F1(a,b;c;x)$ wurde in
Abschnitt~\ref{buch:rekursion:section:hypergeometrische-funktion}
als Potenzreihe mit sehr speziellen Koeffizienten, die sich aus
Pochhammer-Symbolen.
Es stellt sich aber heraus, dass man sie auch als Lösung einer
gewöhnlichen Differentialgleichung bekommen kann, die bereits
Euler studiert hat.

\subsection{Die Eulersche hypergeometrische Differentialgleichung
\label{buch:differentialgleichung:subsection:euler-hypergeometrisch}}
Die hypergeometrische Funktion $\mathstrut_2F_1(a,b;c;x)$ ist eine
Lösung der {\em Eulerschen hypergeometrischen Differentialgleichung}
(zu unterscheiden von der Eulerschen Differentialgleichung, die sich
immer auf eine lineare Differentialgleichung mit konstanten Koeffizienten
reduzieren lässt)
\begin{equation}
x(1-x) \frac{d^2y}{dx^2} + (c-(a+b+1)x)\frac{dy}{dx} - ab y = 0
\label{buch:differentialgleichungen:hypergeo:eulerdgl}
\end{equation}
Wir prüfen dies nach, indem wir die Definition der hypergeometrischen
Funktion 
\begin{align*}
y(x)
&=
\mathstrut_2F_1(a,b;c;x)
=
\sum_{k=0}^\infty
\frac{(a)_k(b)_k}{(c)_k} \frac{x^k}{k!}
\intertext{mit den Ableitungen}
y'(x)
&=
\sum_{k=1}^\infty 
\frac{(a)_k(b)_k}{(c)_k} \frac{x^{k-1}}{(k-1)!}
\\
y''(x)
&=
\sum_{k=2}^\infty 
\frac{(a)_k(b)_k}{(c)_k} \frac{x^{k-2}}{(k-2)!}
\end{align*}
einsetzen.
Die Gleichung, die sich ergibt, ist
\begin{align*}
0
&=
x(1-x)
\sum_{k=2}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^{k-2}}{(k-2)!}
+
(c-(a+b+1)x)
\sum_{k=1}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^{k-1}}{(k-1)!}
-ab
\sum_{k=0}^\infty
\frac{(a)_k(b)_k}{(c)_k} \frac{x^k}{k!}
\\
&=
\sum_{k=2}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^{k-1}}{(k-2)!}
-
\sum_{k=2}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^k}{(k-2)!}
+
c\sum_{k=1}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^{k-1}}{(k-1)!}
\\
&\qquad
-(a+b+1)
\sum_{k=1}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^k}{(k-1)!}
-ab
\sum_{k=0}^\infty
\frac{(a)_k(b)_k}{(c)_k} \frac{x^k}{k!}
\\
&=
\sum_{k=1}^\infty
\frac{(a)_{k+1}(b)_{k+1}}{(c)_{k+1}}\frac{x^k}{(k-1)!}
-
\sum_{k=2}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^k}{(k-2)!}
+
c\sum_{k=0}^\infty
\frac{(a)_{k+1}(b)_{k+1}}{(c)_{k+1}}\frac{x^k}{k!}
\\
&\qquad
-(a+b+1)
\sum_{k=1}^\infty
\frac{(a)_k(b)_k}{(c)_k}\frac{x^k}{(k-1)!}
-ab
\sum_{k=0}^\infty
\frac{(a)_k(b)_k}{(c)_k} \frac{x^k}{k!}.
\end{align*}
Zum konstanten Koeffizienten für $k=0$ tragen nur die dritte und letzte
Summe bei, dies sind die Terme
\[
c\frac{(a)_1(b)_1}{(c)_1}-ab\frac{(a)_0(b)_0}{(c)_0}
=
c\frac{ab}{c}-ab\frac{1\cdot 1}{1}
=
0.
\]
Für den linearen Term $k=1$ kommen je ein Term aus der ersten aund vierten
Summe hinzu, dies ergibt
\begin{align*}
&\phantom{\mathstrut=\mathstrut}
\frac{(a)_2(b)_2}{(c)_2}
+c\frac{(a)_2(b)_2}{(c)_2}
-(a+b+1)\frac{(a)_1(b)_1}{(c)_1}
-ab\frac{(a)_1(b)_1}{(c)_1}
\\
&=
\frac{a(a+1)b(b+1)}{c(c+1)}
(1+c)
-(ab+a+b+1)
\frac{ab}{c}
\\
&=
\frac{a(a+1)b(b+1)}{c}
-
(a+1)(b+1)\frac{ab}{c}
=0.
\end{align*}
Durch Koeffizientenvergleich erhalten wir für $k\ge 2$ 
\begin{align*}
0
&=
\frac{(a)_{k+1}(b)_{k+1}}{(c)_{k+1}} \frac1{(k-1)!} 
-
\frac{(a)_k(b)_k}{(c)_k} \frac1{(k-2)!} 
+
c\frac{(a)_{k+1}(b)_{k+1}}{(c)_{k+1}} \frac{1}{k!}
\\
&\qquad
-(a+b+1)\frac{(a)_k(b)_k}{(c)_k}\frac{1}{(k-1)!}
-ab \frac{(a)_k(b)_k}{(c)_k}\frac{1}{k!}
\\
&=
\frac{(a)_k(b)_k}{(c)_{k+1}}
\frac{1}{k!}
\biggl(
(a+k)(b+k)k
-(c+k)(k-1)k
+
c(a+k)(b+k)
\\
&\qquad
\qquad
\qquad
-(a+b+1)(c+k)k
-ab(c+k)
\biggr).
\intertext{Der zweite, vierte und fünfte Term können zu}
&=
\frac{(a)_k(b)_k}{(c)_{k+1}}
\frac{1}{k!}
\biggl(
(a+k)(b+k)k
+
c(a+k)(b+k)
-(ab+ak+bk+k^2)(c+k)
\biggr)
\intertext{zusammengefasst werden.
Der Faktor $(ab+ak+bk+k^2)$ kann als Produkt $(a+k)(b+k)$ faktorisiert
werden, der dann als gemeinsamer Faktor aus allen Termen ausgeklammert
werden kann:}
&=
\frac{(a)_k(b)_k}{(c)_{k+1}}
\frac{1}{k!}
\biggl(
(a+k)(b+k)k
+
c(a+k)(b+k)
-(a+k)(b+k)(c+k)
\biggr)
\\
&=
\frac{(a)_{k+1}(b)_{k+1}}{(c)_{k+1}}
\frac{1}{k!}
\biggl(
k
+
c
-(c+k)
\biggr)
=0.
\end{align*}
Damit ist gezeigt, dass $\mathstrut_2F_1(a,b;c;x)$ eine Lösung
der Differentialgleichung ist.

Die hypergeometrische Reihe kann auch direkt mit Hilfe der
Potenzreihenmethode als Lösung der Differentialgleichung gefunden 
werden.

\subsection{Lösung als verallgemeinerte Potenzreihe}
Da die hypergeometrische Reihe eine Differentialgleichung
zweiter Ordnung mit einer Singularität bei $x=0$ ist, 
kann man versuchen eine zweite, linear unabhängige Lösung mit
Hilfe der Methode der verallgemeinerten Potenzreihen zu finden.
Dazu setzt man die Lösung in der Form
\begin{align*}
y_2(x)
&=
\sum_{k=0}^\infty a_kx^{\varrho+k}
&
&\Rightarrow&
y_2'(x)
&=
\sum_{k=0}^\infty (\varrho+k)a_kx^{\varrho+k-1}
\\
&&
&&
y_2''(x)
&=
\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k-2}
\end{align*}
an, wobei $a_0\ne 0$ sein soll.
Einsetzen in die Differentialgleichung ergibt
\begin{align*}
0&=
x(1-x)y_2''(x) + (c-(a+b+1)x) y_2'(x) -aby_2(x)
\\
&=
x(1-x)
\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k-2}
+
(c-(a+b+1)x)
\sum_{k=0}^\infty (\varrho+k)a_kx^{\varrho+k-1}
-
abx^{\varrho}\sum_{k=0}^\infty a_kx^{\varrho+k}
\\
&=
-\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k}
+
\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k-1}
+
c
\sum_{k=0}^\infty (\varrho+k)a_kx^{\varrho+k-1}
\\
&\qquad
-
(a+b+1)
\sum_{k=0}^\infty (\varrho+k)a_kx^{\varrho+k}
-
ab
\sum_{k=0}^\infty a_kx^{\varrho+k}.
\intertext{Durch Verschiebung des Summationsindex in der zweiten
und dritten Summe wird der Koeffizientenvergleich etwas
einfacher}
&=
-\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k}
+
\sum_{k=-1}^\infty (\varrho+k+1)(\varrho+k)a_{k+1}x^{\varrho+k}
+
c
\sum_{k=-1}^\infty (\varrho+k+1)a_{k+1}x^{\varrho+k}
\\
&\qquad
-
(a+b+1)
\sum_{k=0}^\infty (\varrho+k)a_kx^{\varrho+k}
-
ab
\sum_{k=0}^\infty a_kx^{\varrho+k}
\\
&=
-\sum_{k=0}^\infty (\varrho+k)(\varrho+k-1)a_kx^{\varrho+k}
+
\sum_{k=-1}^\infty (\varrho+k+1)(\varrho+k+c)a_{k+1}x^{\varrho+k}
\\
&\qquad
-
\sum_{k=0}^\infty ((\varrho+k)(a+b+1)+ab)a_kx^{\varrho+k}
\\
&=
\bigl(
\varrho(\varrho-1)
+c\varrho \bigr)
x^{\varrho-1}
+
\sum_{k=0}^\infty
\bigl(
-(\varrho+k)(\varrho+k-1)a_k
+(\varrho+k+1)(\varrho+k+c)a_{k+1}
\\
&
\qquad
\qquad
\qquad
\qquad
\qquad
\qquad
-((\varrho+k)(a+b+1)+ab)a_k
\bigr)
x^{\varrho+k}.
\end{align*}
Aus dem ersten Term kann man die Indexgleichung
\[
0
=
\varrho(\varrho-1)+c\varrho
=
\varrho(\varrho-1+c)
\]
ablesen, die die Nullstellen $\varrho=0$ und $\varrho=1-c$ hat.
Die Nullstelle $\varrho=0$ ergibt natürlich die bereits gefundene
hypergeometrische Reihe.

Nach Einsetzen der zweiten Lösung der Indexgleichung in der Summe
legt der Koeffizientenvergleich eine Beziehung
\begin{align}
0
&=
\bigl(
-(k-c+1)(k-c)
-(k-c+1)(a+b+1)+ab
\bigr)a_k
+
(k-c+2)(k+1)
a_{k+1} 
\notag
\intertext{zwischen $a_k$ und $a_{k+1}$ fest.
Daraus kann man den Quotienten aufeinanderfolgender
Koeffizienten als}
\frac{a_{k+1}}{a_k}
&=
\frac{
-(k-c+1)(k-c)
-(k-c+1)(a+b+1)+ab
}{
\notag
(k-c+2)(k+1)
}
\\
&=
%(%i4) factor(coeff(y,q,0))
%(%o4)                  - (k - c + a + 1) (k - c + b + 1)
%(%i5) factor(coeff(y,q,1))
%(%o5)                         (k + 1) (k - c + 2)
\frac{
(a-c+1+k)
(b-c+1+k)
}{
(2-c+k)(k+1)
}
\label{buch:differentialgleichungen:hypergeo:verallgkoef}
\end{align}
finden.
Setzt man $a_0=1$, ist die zweite Lösung ist also wieder eine
hypergeometrische Funktion.%, nämlich
%\[
%y_2(x)
%=
%x^{1-c}
%\sum_{k=0}^\infty \frac{(a-c+1)_k(b-c+1)_k}{(2-c)_k}\frac{x^k}{k!}
%=
%x^{1-c}
%\mathstrut_2F_1\biggl(\begin{matrix}a-c+1,b-c+1\\2-c\end{matrix};x\biggr)
%\]
Diese Lösung ist aber nur möglich, wenn in
\eqref{buch:differentialgleichungen:hypergeo:verallgkoef}
der Nenner nicht verschwindet, d.~h.~$2-c+k\ne 0$
oder $c \ne k+2$ für all natürlichen $k$.
$c$ darf also kein natürliche Zahl $\ge 2$ sein.
Wir fassen die Resultate dieses Abschnitts im folgenden Satz zusammen.

\begin{satz}
Die eulersche hypergeometrische Differentialgleichung
\begin{equation}
x(1-x)\frac{d^2y}{dx^2}
+(c+(a+b+1)x)\frac{dy}{dx}
-ab y
=
0
\end{equation}
hat die Lösung
\[
y_1(x)
=
\mathstrut_2F_1\biggl(\begin{matrix}a,b\\c\end{matrix};x\biggr).
\]
Falls $c-2\not\in \mathbb{N}$ ist, ist
\[
y_2(x)
=
x^{1-c} \mathstrut_2F_1\biggl(\begin{matrix}a-c+1,b-c+1\\2-c\end{matrix};x\biggr)
\]
eine zweite, linear unabhängige Lösung.
\end{satz}

%
% Die verallgemeinerte hypergeometrische Differentialgleichung
%
\subsection{Verallgemeinerte hypergeometrische Differentialgleichung}
% https://de.wikipedia.org/wiki/Verallgemeinerte_hypergeometrische_Funktion





